webpackJsonp([49],{188:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=t(4015);t.n(r);Jane.module("left.js",(function(){t(4016),t(4019),t(4020),t(4050)}))},4015:function(e,o){},4016:function(e,o,t){t(4017),t(4018)},4017:function(e,o){!(function(){function e(){ns.events.off("onCollectorCheckStart"),ns.events.off("onCollectorCheckSuccess"),ns.events.off("onCollectorCheckFail"),ns.events.off("onCollectorEditFail"),ns.events.off("daria:oauth-token:update")}ns.action.define("collector.update-oauth-token",(function(e,o,t,r){ns.events.on("daria:oauth-token:update",(function(e,o){$(t).find('[name="social_task_id"]').val(o.task_id),ns.action.run("collector.edit-password",o,t,r)})),ns.action.run("generate-oauth-token",o)})),ns.action.define("collector.warning",(function(e,t,r,n){var s;n?(s=n.target,Jane.c(["Left column","Broken collector","click on stripe"])):s=t;var i=$(s).closest(".js-collectors-item-warning"),a=i.prev(),l=a.attr("data-popid"),d=ns.Model.get("collectors"),c=d.getById(l);if(c){var u={};$.each(c,(function(e,o){if("password"===e)return!0;u[e]=o})),"1"===c.is_oauth&&(u.social_task_id="");var f=a.text(),m=a.data("help-link"),h=a.data("company")||f.split("@")[1],p={hidden:u,mail:f,popid:l,is_oauth:c.is_oauth,oauth_app:c.oauth_app,time:c.human_time,server:h,company:h.substr(0,1).toUpperCase()+h.substr(1)};m&&(p.link=m);var g=a.offset().top+a.outerHeight()/2+1;o(a,p).find("form, .b-mail-button").filter("form").data({popid:l,y:g,$warning:i,$unactive:a})}})),ns.action.define("collector.edit-password",(function(o,t,r,n){function s(o,t){e(),ns.events.trigger("daria:vCollectors:log","click on new password error"),window.clearTimeout(a),m.addClass("g-hidden"),(t&&"1"===t.is_oauth?f:u).removeClass("g-hidden"),Jane.enableButton(h)}var i={event:n,params:t};i.event.preventDefault();var a,l=$(i.event.target),d=l.data(),c=l.find(".b-notification_loading, .b-mail-button, .b-notification_auth_failed, .b-notification_oauth_failed"),u=c.filter(".b-notification_auth_failed"),f=c.filter(".b-notification_oauth_failed"),m=c.filter(".b-notification_loading"),h=c.filter(".b-mail-button");e(),ns.events.on("onCollectorCheckStart",(function(){a=window.setTimeout((function(){m.removeClass("g-hidden"),u.addClass("g-hidden")}),250)})),ns.events.on("onCollectorCheckFail",s),ns.events.on("onCollectorEditFail",s),ns.events.on("onCollectorEditSuccess.password-"+i.params.popid,(function(){e(),ns.events.trigger("daria:vCollectors:log","click on new password success"),window.clearTimeout(a),ns.forcedRequest(["do-collector-run","do-collector-on"],{popid:d.popid}),Daria.Dialog.open({body:Jane.tt("left:collector-warning-popup-header",{header:i18n("%Setup_Collectors_Сбор_писем_прождолжен"),src:"b-mail-icon_green-tick.gif"}),onTarget:{target:$(".js-collector-unactive[data-popid="+i.params.popid+"]"),side:"left",pos:"top"},onopen:function(){window.setTimeout((function(){Daria.Dialog.$dialog.hasClass("b-collectors__tick")&&Daria.Dialog.close()}),2e3)},additionalClass:"b-popup_yellow b-collectors__popup b-collectors__tick"}),d.$warning.remove()})),Jane.Services.runModules(["setup.js"],(function(){Daria.Collectors.Editor.run(l,i.params.owner)}))})),ns.action.define("collector.stop",(function(e,o,t,r){var n={event:r,params:o};ns.events.trigger("daria:vCollectors:log","click on stop message collecting");var s={};n.event&&(s=$(n.event.target).closest("form").data()),Daria.Dialog.close().open({title:Jane.tt("left:collector-warning-popup-header",{header:i18n("%Setup_Collectors_remove")}),body:Jane.tt("left:collector-remove-popup",{mail:n.params.mail,popid:n.params.popid}),width:480,onTarget:{x:$(".ns-view-left-box").outerWidth()+9,y:s.y-$(window).scrollTop(),side:"left",pos:"top"},additionalClass:"b-popup_yellow b-collectors__popup"}).$dialog.data(s)})),ns.action.define("collector.kill",(function(e,o){var t=o.popid;ns.forcedRequest([{id:"do-collector-remove",params:{popid:t}},{model:ns.Model.get("collectors").getMasterRequest()}]).then((function(){var e=Vow.resolve(),o=ns.Model.get("filters").getForCollector(t),r=_.map(o,(function(e){return{id:"do-filters-delete",params:{id:e.filid}}}));r.length&&(e=ns.forcedRequest([].concat(r,[{model:ns.Model.get("filters").getMasterRequest()}]))),e.then((function(){ns.events.atrigger("daria:vCollectors:update")}))})),Daria.Dialog.close()})),ns.action.define("collector.close-remove-popup",(function(){Daria.Dialog.close()})),ns.action.define("collector.help-go",(function(){return ns.events.trigger("daria:vCollectors:log","go to settings"),!0})),ns.action.define("collector.support-go",(function(){return ns.events.trigger("daria:vCollectors:log","go to support"),!0})),ns.action.define("message-collector.disable",(function(){var e={no_collectors_promo:!0};return ns.Model.get("settings").setSettings(e,(function(){ns.events.trigger("daria:vCollectors:update")})),Jane.c("message-collector","Клик на нет других ящиков"),!0}));var o=function(e,o){var n="1"===o.is_oauth?"left:oauth-collector-warning-popup":"left:collector-warning-popup";Daria.Dialog.open({title:Jane.tt("left:collector-warning-popup-header",{header:i18n("%Setup_Collectors_warning-popup-header",_.escape(o.mail))}),body:Jane.tt(n,o),width:480,onopen:function(o){Jane.c(["Left column","Broken collector","show"]),o._repositionDialog=r.bind(this,e),ns.events.on("minify",o._repositionDialog)},onTarget:t(e),onclose:function(e){ns.events.trigger("daria:vCollectors:log","closing popup"),ns.events.trigger("daria:vCollectors:setBrokenCollectorCookie"),ns.events.off("minify",e._repositionDialog),delete e._repositionDialog},oncancel:function(){Jane.c("Left column","Collectors promo","Click on cross")},additionalClass:"b-popup_yellow b-collectors__popup"});var s=Daria.Dialog.$dialog,i=s.find(".js-dialog-button");return s.on("keyup",".js-collector-passwd",(function(){var e=nb.block(i.get(0)),o=nb.block(this);return e?$.trim(o.getValue())?void e.enable():void e.disable():e})),s},t=function(e,o){var t={default:{target:e,side:"left",pos:"top",needTail:!0}};return o&&Object.assign(t.default,{newTop:o}),t.default},r=function(e,o){Daria.Dialog.params.onTarget=t(e,o),Daria.Dialog.position()}})()},4018:function(e,o){ns.action.define("hide",(function(e,o,t){t.style.display="none"}))},4019:function(e,o){ns.layout.define("common-folder-layout",{folder:{}}),ns.layout.define("user-folder-layout",{"user-folder":{}}),ns.layout.define("system-folder-layout",{"system-folder":{}}),ns.layout.define("label",{label:{}}),ns.layout.define("collectors-item",{"collectors-item":{}})},4020:function(e,o,t){t(4021),t(4024),t(4025),t(4026),t(4027),t(4028),t(4029),t(4030),t(4031),t(4032),t(4033),t(4034),t(4035),t(4036),t(4037),t(4038),t(4039),t(4040),t(4041),t(4042),t(4043),t(4044),t(4045),t(4046),t(4047),t(4048),t(4049)},4021:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=t(4022);t.n(r);!(function(){var e={useSSL:!0,useProtocol:"imap",imap:{port:143,tpl:"login@domain",ssl:{port:993}},pop:{port:110,tpl:"login@domain",ssl:{port:995}}};ns.Model.define("collector-settings",{events:{"ns-model-init":function(){this.setData(r.WellKnownCollectorSettings)}},methods:{getDefaultConfig:function(o,t){var r=$.extend({},e);return void 0!==o&&null!==o||(o=r.useProtocol),$.extend(r,r[o]),void 0!==t&&null!==t||(t=r.useSSL),t&&$.extend(r,r[o].ssl||{}),r.useProtocol=o,r.useSSL=t,delete r.imap,delete r.pop,delete r.ssl,r},getByDomain:function(o,t,r){if(!o)return null;for(var n,s=this.getData(),i=0,a=s.length;i<a;i++){var l=s[i];if(l.name&&$.inArray(o,l.name)>-1){n=$.extend(!0,{},e,l);break}}if(!n)return null;if(void 0!==t&&null!==t||(t=n.imap?"imap":"pop"),!n[t])return null;if($.extend(n,n[t]),void 0!==r&&null!==r||(r=n.useSSL),r){if(!n[t].ssl)return null;$.extend(n,n[t].ssl||{})}return n.useProtocol=t,n.useSSL=r,delete n.imap,delete n.pop,delete n.name,delete n.ssl,n},getByServer:function(e){return _.find(this.getData(),(function(o){return o.pop&&o.pop.server===e||o.imap&&o.imap.server===e}))}}},ns.ModelStatic)})()},4022:function(e,o,t){"use strict";var r,n,s,i,a,l,d,c,u,f,m,h,p,g,v,P,b,y,_,w,M,S,C,I,k,A,F,O,L,D,E,x,B,U,T,j,N,R,V,W,$,H,z,K,J,q,X,Y,G,Q,Z,ee,oe,te,re,ne,se,ie,ae,le,de,ce,ue,fe,me,he,pe,ge,ve,Pe,be,ye,_e,we,Me,Se,Ce,Ie,ke,Ae,Fe,Oe,Le,De,Ee,xe,Be,Ue,Te,je,Ne,Re,Ve,We,$e,He,ze,Ke,Je,qe,Xe,Ye,Ge,Qe,Ze,eo,oo,to,ro,no,so,io,ao,lo,co;Object.defineProperty(o,"__esModule",{value:!0}),o.WellKnownCollectorSettings=void 0;var uo=t(4023);o.WellKnownCollectorSettings=[(r={name:["mail.ru"],useProtocol:uo.Protocols.IMAP},r[uo.Protocols.IMAP]={server:"imap.mail.ru"},r[uo.Protocols.POP]={server:"pop.mail.ru",tpl:"login"},r.teaser="mail",r.help="http://help.mail.ru/mail-support",r.company="mail.ru",r.SSLOnly=!0,r),(n={name:["list.ru"],useProtocol:uo.Protocols.IMAP},n[uo.Protocols.IMAP]={server:"imap.mail.ru"},n[uo.Protocols.POP]={server:"pop.list.ru",tpl:"login"},n.favicon="mail.ru",n.teaser="mail",n.help="http://help.mail.ru/mail-support",n.company="mail.ru",n.SSLOnly=!0,n),(s={name:["bk.ru"],useProtocol:uo.Protocols.IMAP},s[uo.Protocols.IMAP]={server:"imap.mail.ru"},s[uo.Protocols.POP]={server:"pop.bk.ru",tpl:"login"},s.favicon="mail.ru",s.teaser="mail",s.help="http://help.mail.ru/mail-support",s.company="mail.ru",s.SSLOnly=!0,s),(i={name:["inbox.ru"],useProtocol:uo.Protocols.IMAP},i[uo.Protocols.IMAP]={server:"imap.mail.ru"},i[uo.Protocols.POP]={server:"pop.inbox.ru",tpl:"login"},i.favicon="mail.ru",i.teaser="mail",i.help="http://help.mail.ru/mail-support",i.company="mail.ru",i.SSLOnly=!0,i),(a={name:["gmail.com"],useProtocol:uo.Protocols.IMAP},a[uo.Protocols.IMAP]={server:"imap.gmail.com"},a[uo.Protocols.POP]={server:"pop.gmail.com"},a.favicon="mail.google.com",a.teaser="gmail",a.help="http://support.google.com/mail",a.company="gmail.com",a),(l={name:["km.ru"],useSSL:!1},l[uo.Protocols.IMAP]=null,l[uo.Protocols.POP]={server:"pop.km.ru"},l),(d={name:["bossmail.ru"],useSSL:!1},d[uo.Protocols.IMAP]=null,d[uo.Protocols.POP]={server:"pop.bossmail.ru"},d.favicon="km.ru",d),(c={name:["girlmail.ru"],useSSL:!1},c[uo.Protocols.IMAP]=null,c[uo.Protocols.POP]={server:"pop.girlmail.ru"},c.favicon="km.ru",c),(u={name:["boymail.ru"],useSSL:!1},u[uo.Protocols.IMAP]=null,u[uo.Protocols.POP]={server:"pop.boymail.ru"},u.favicon="km.ru",u),(f={name:["freemail.ru"],useSSL:!1},f[uo.Protocols.IMAP]=null,f[uo.Protocols.POP]={server:"pop.freemail.ru"},f.favicon="km.ru",f),(m={name:["megabox.ru"],useSSL:!1},m[uo.Protocols.IMAP]=null,m[uo.Protocols.POP]={server:"pop.megabox.ru"},m.favicon="km.ru",m),(h={name:["safebox.ru"],useSSL:!1},h[uo.Protocols.IMAP]=null,h[uo.Protocols.POP]={server:"pop.safebox.ru"},h.favicon="km.ru",h),(p={name:["ua.fm"]},p[uo.Protocols.IMAP]=null,p[uo.Protocols.POP]={server:"pop.ua.fm"},p.favicon="i.ua",p),(g={name:["ngs.ru","eml.ru","mosk.ru"]},g[uo.Protocols.IMAP]=null,g[uo.Protocols.POP]={server:"mail.ngs.ru"},g),(v={name:["mtu.ru","mtu-net.ru"],useSSL:!1},v[uo.Protocols.IMAP]=null,v[uo.Protocols.POP]={server:"pop.mtu.ru"},v.favicon="mts.ru",v),(P={name:["umail.ru"]},P[uo.Protocols.IMAP]=null,P[uo.Protocols.POP]={server:"pop.umail.ru",tpl:"login"},P),(b={name:["nic.ru"],useProtocol:uo.Protocols.IMAP},b[uo.Protocols.IMAP]={server:"mail.nic.ru",tpl:"login"},b[uo.Protocols.POP]={server:"mail.nic.ru",tpl:"login"},b),(y={name:["i.ua"]},y[uo.Protocols.IMAP]=null,y[uo.Protocols.POP]={server:"pop.i.ua"},y),(_={name:["yahoo.com","yahoo.co.kr","yahoo.co.nz","yahoo.com.mx","yahoo.com.tr","yahoo.dk","yahoo.gr","yahoo.ie","yahoo.in","yahoo.nl","yahoo.no","yahoo.pl","yahoo.ru","yahoo.se","yahoo.","yahoo.","yahoo.","yahoo."],useProtocol:uo.Protocols.IMAP},_[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},_[uo.Protocols.POP]={server:"pop.mail.yahoo.com"},_.teaser="yahoo",_),(w={name:["yahoo.ca"],useProtocol:uo.Protocols.IMAP},w[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},w[uo.Protocols.POP]={server:"pop.mail.yahoo.ca"},w.teaser="yahoo",w),(M={name:["yahoo.cn"],useProtocol:uo.Protocols.IMAP},M[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},M[uo.Protocols.POP]={server:"pop.mail.yahoo.cn"},M.teaser="yahoo",M),(S={name:["yahoo.co.id"],useProtocol:uo.Protocols.IMAP},S[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},S[uo.Protocols.POP]={server:"pop.mail.yahoo.co.id"},S.teaser="yahoo",S),(C={name:["yahoo.co.in"],useProtocol:uo.Protocols.IMAP},C[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},C[uo.Protocols.POP]={server:"pop.mail.yahoo.co.in"},C.teaser="yahoo",C),(I={name:["yahoo.co.jp"],useProtocol:uo.Protocols.IMAP},I[uo.Protocols.IMAP]={server:"imap.mail.yahoo.co.jp"},I[uo.Protocols.POP]={server:"pop.mail.yahoo.co.jp",tpl:"login"},I.teaser="yahoo",I),(k={name:["yahoo.co.th"],useProtocol:uo.Protocols.IMAP},k[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},k[uo.Protocols.POP]={server:"pop.mail.yahoo.co.th"},k.teaser="yahoo",k),(A={name:["yahoo.co.uk"],useProtocol:uo.Protocols.IMAP},A[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},A[uo.Protocols.POP]={server:"pop.mail.yahoo.co.uk"},A.teaser="yahoo",A),(F={name:["yahoo.com.ar"],useProtocol:uo.Protocols.IMAP},F[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},F[uo.Protocols.POP]={server:"pop.mail.yahoo.com.ar"},F.teaser="yahoo",F),(O={name:["yahoo.com.au"],useProtocol:uo.Protocols.IMAP},O[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},O[uo.Protocols.POP]={server:"pop.mail.yahoo.com.au"},O.teaser="yahoo",O),(L={name:["yahoo.com.br"],useProtocol:uo.Protocols.IMAP},L[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},L[uo.Protocols.POP]={server:"pop.mail.yahoo.com.br"},L.teaser="yahoo",L),(D={name:["yahoo.com.cn"],useProtocol:uo.Protocols.IMAP},D[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},D[uo.Protocols.POP]={server:"pop.mail.yahoo.com.cn"},D.teaser="yahoo",D),(E={name:["yahoo.com.hk"],useProtocol:uo.Protocols.IMAP},E[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},E[uo.Protocols.POP]={server:"pop.mail.yahoo.com.hk"},E.teaser="yahoo",E),(x={name:["yahoo.com.my"],useProtocol:uo.Protocols.IMAP},x[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},x[uo.Protocols.POP]={server:"pop.mail.yahoo.com.my"},x.teaser="yahoo",x),(B={name:["yahoo.com.pe"],useProtocol:uo.Protocols.IMAP},B[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},B[uo.Protocols.POP]={server:"pop.mail.yahoo.com.ar"},B.teaser="yahoo",B),(U={name:["yahoo.com.ph"],useProtocol:uo.Protocols.IMAP},U[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},U[uo.Protocols.POP]={server:"pop.mail.yahoo.com.ph"},U.teaser="yahoo",U),(T={name:["yahoo.com.sg"],useProtocol:uo.Protocols.IMAP},T[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},T[uo.Protocols.POP]={server:"pop.mail.yahoo.com.sg"},T.teaser="yahoo",T),(j={name:["yahoo.com.tw"],useProtocol:uo.Protocols.IMAP},j[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},j[uo.Protocols.POP]={server:"pop.mail.yahoo.com.tw"},j.teaser="yahoo",j),(N={name:["yahoo.com.vn"],useProtocol:uo.Protocols.IMAP},N[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},N[uo.Protocols.POP]={server:"pop.mail.yahoo.com.vn"},N.teaser="yahoo",N),(R={name:["yahoo.de"],useProtocol:uo.Protocols.IMAP},R[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},R[uo.Protocols.POP]={server:"pop.mail.yahoo.de"},R.teaser="yahoo",R),(V={name:["yahoo.es"],useProtocol:uo.Protocols.IMAP},V[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},V[uo.Protocols.POP]={server:"pop.mail.yahoo.es"},V.teaser="yahoo",V),(W={name:["yahoo.fr"],useProtocol:uo.Protocols.IMAP},W[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},W[uo.Protocols.POP]={server:"pop.mail.yahoo.fr"},W.teaser="yahoo",W),($={name:["yahoo.it"],useProtocol:uo.Protocols.IMAP},$[uo.Protocols.IMAP]={server:"imap.mail.yahoo.com"},$[uo.Protocols.POP]={server:"pop.mail.yahoo.it"},$.teaser="yahoo",$),(H={name:["ameritech.net"]},H[uo.Protocols.IMAP]=null,H[uo.Protocols.POP]={server:"pop.ameritech.yahoo.com"},H.teaser="yahoo",H),(z={name:["flash.net"]},z[uo.Protocols.IMAP]=null,z[uo.Protocols.POP]={server:"pop.flash.yahoo.com"},z.teaser="yahoo",z),(K={name:["nvbell.net"]},K[uo.Protocols.IMAP]=null,K[uo.Protocols.POP]={server:"pop.nvbell.yahoo.com"},K.teaser="yahoo",K),(J={name:["pacbell.net"]},J[uo.Protocols.IMAP]=null,J[uo.Protocols.POP]={server:"pop.pacbell.yahoo.com"},J.teaser="yahoo",J),(q={name:["prodigy.net"]},q[uo.Protocols.IMAP]=null,q[uo.Protocols.POP]={server:"pop.prodigy.yahoo.com"},q.teaser="yahoo",q),(X={name:["sbcglobal.net"]},X[uo.Protocols.IMAP]=null,X[uo.Protocols.POP]={server:"pop.sbcglobal.yahoo.com"},X.teaser="yahoo",X),(Y={name:["snet.net"]},Y[uo.Protocols.IMAP]=null,Y[uo.Protocols.POP]={server:"pop.snet.yahoo.com"},Y.teaser="yahoo",Y),(G={name:["swbell.net"]},G[uo.Protocols.IMAP]=null,G[uo.Protocols.POP]={server:"pop.swbell.yahoo.com"},G.teaser="yahoo",G),(Q={name:["verizon.net"]},Q[uo.Protocols.IMAP]=null,Q[uo.Protocols.POP]={server:"incoming.yahoo.verizon.net"},Q.teaser="yahoo",Q),(Z={name:["wans.net"]},Z[uo.Protocols.IMAP]=null,Z[uo.Protocols.POP]={server:"pop.wans.yahoo.com"},Z.teaser="yahoo",Z),(ee={name:["btinternet.com"]},ee[uo.Protocols.IMAP]=null,ee[uo.Protocols.POP]={server:"mail.btinternet.com"},ee.teaser="yahoo",ee),(oe={name:["rogers.com","nl.rogers.com"]},oe[uo.Protocols.IMAP]=null,oe[uo.Protocols.POP]={server:"pop.broadband.rogers.com"},oe.teaser="yahoo",oe),(te={name:["aol.com"],useSSL:!1,useProtocol:uo.Protocols.IMAP},te[uo.Protocols.IMAP]={server:"imap.aol.com",tpl:"login"},te[uo.Protocols.POP]={server:"pop.aol.com",tpl:"login"},te.favicon="aol.com",te.teaser="aol",te),(re={name:["wow.com","love.com","game.com"],useSSL:!1,useProtocol:uo.Protocols.IMAP},re[uo.Protocols.IMAP]={server:"imap.aol.com",tpl:"login"},re[uo.Protocols.POP]={server:"pop.aol.com",tpl:"login"},re.teaser="aol",re),(ne={name:["rol.ru"],useProtocol:uo.Protocols.IMAP},ne[uo.Protocols.IMAP]={server:"imap.rol.ru"},ne[uo.Protocols.POP]={server:"pop.rol.ru"},ne),(se={name:["ukr.net"],useProtocol:uo.Protocols.IMAP},se[uo.Protocols.IMAP]={server:"imap.ukr.net"},se[uo.Protocols.POP]={server:"pop3.ukr.net"},se),(ie={name:["freemail.ukr.net"]},ie[uo.Protocols.IMAP]=null,ie[uo.Protocols.POP]={server:"freemail.ukr.net"},ie),(ae={name:["infobox.ru"]},ae[uo.Protocols.IMAP]=null,ae[uo.Protocols.POP]={server:"mail.infobox.ru"},ae),(le={name:["mtw.ru"],useProtocol:uo.Protocols.IMAP},le[uo.Protocols.IMAP]={server:"imap.mtw.ru",tpl:"login"},le[uo.Protocols.POP]={server:"pop.mtw.ru",tpl:"login"},le),(de={name:["aaanet.ru"],useSSL:!1},de[uo.Protocols.IMAP]=null,de[uo.Protocols.POP]={server:"pop3.aaanet.ru",tpl:"login"},de),(ce={name:["tochka.ru"]},ce[uo.Protocols.IMAP]=null,ce[uo.Protocols.POP]={server:"pop.tochka.ru",tpl:"login"},ce),(ue={name:["mx.kaluga.ru"]},ue[uo.Protocols.IMAP]=null,ue[uo.Protocols.POP]={server:"mx.kaluga.ru",tpl:"login"},ue.favicon="kaluga.ru",ue),(fe={name:["permonline.ru"]},fe[uo.Protocols.IMAP]=null,fe[uo.Protocols.POP]={server:"pop.permonline.ru"},fe),(me={name:["yandex.ru","narod.ru","ya.ru","yandex.com","yandex.com.tr","yandex.ua","yandex.kz","yandex.by","yandex.az","yandex.com.am","yandex.com.ge","yandex.co.il","yandex.kg","yandex.lv","yandex.lt","yandex.md","yandex.tj","yandex.tm","yandex.uz","yandex.fr","yandex.ee","яндекс.рф","aeterna.ru","avril.ru","borda.ru","fotoplenka.ru","fromru.com","front.ru","hotbox.ru","hotmail.ru","justlunch.ru","krovatka.su","land.ru","loveplanet.ru","mail15.com","mail333.com","memori.ru","newmail.ru","nightmail.ru","nm.ru","photofile.ru","pisem.net","pochta.com","pochta.ru","pochtamt.ru","pop3.ru","qip.ru","rbcmail.ru","smtp.ru","webmail.ru","zahvat.ru","ziza.ru","5ballov.ru","e1.ru"],useProtocol:uo.Protocols.IMAP},me[uo.Protocols.IMAP]={server:"imap.yandex.ru"},me[uo.Protocols.POP]={server:"pop.yandex.ru"},me.favicon="mail.yandex.ru",me.isOwn=!0,me.teaser="yandex",me.help="https://yandex.ru/support/mail/web/preferences/collector.html#collector-problems__yes",me),(he={name:["mynet.com"]},he[uo.Protocols.IMAP]=null,he[uo.Protocols.POP]={server:"pop.mynet.com"},he.useSSL=!1,he),(pe={name:["superonline.com"]},pe[uo.Protocols.IMAP]={server:"mail.superonline.com"},pe[uo.Protocols.POP]=null,pe.useProtocol=uo.Protocols.IMAP,pe.useSSL=!0,pe),(ge={name:["e-kolay.net"]},ge[uo.Protocols.IMAP]={server:"pop3.e-kolay.net"},ge[uo.Protocols.POP]=null,ge.useProtocol=uo.Protocols.IMAP,ge.useSSL=!0,ge.favicon="ekolay.net",ge),(ve={name:["ttnet.net.tr"]},ve[uo.Protocols.IMAP]={server:"mail.ttnet.net.tr"},ve[uo.Protocols.POP]=null,ve.useProtocol=uo.Protocols.IMAP,ve.useSSL=!0,ve.favicon="ttnet.com.tr",ve),(Pe={name:["turk.net"]},Pe[uo.Protocols.IMAP]={server:"pop3.turk.net"},Pe[uo.Protocols.POP]=null,Pe.useProtocol=uo.Protocols.IMAP,Pe.useSSL=!0,Pe),(be={name:["mynet.com.tr"]},be[uo.Protocols.IMAP]=null,be[uo.Protocols.POP]={server:"pop.mynet.com.tr"},be.favicon="mynet.com",be),(ye={name:["74.ru","chelyabinsk.ru","chel.ru","domchel.ru","autochel.ru","chelfin.ru","mychel.ru","2074.ru","cheldiplom.ru"]},ye[uo.Protocols.IMAP]=null,ye[uo.Protocols.POP]={server:"pop3.74.ru"},ye),(_e={name:["t-online.de"],useProtocol:uo.Protocols.IMAP},_e[uo.Protocols.IMAP]={server:"secureimap.t-online.de"},_e[uo.Protocols.POP]={server:"popmail.t-online.de"},_e.teaser="yahoo",_e),(we={name:["alice.fr","aliceadsl.fr"]},we[uo.Protocols.IMAP]=null,we[uo.Protocols.POP]={server:"pop.alice.fr"},we.teaser="yahoo",we),(Me={name:["arcor.de"],useProtocol:uo.Protocols.IMAP},Me[uo.Protocols.IMAP]={server:"imap.arcor.de",tpl:"login"},Me[uo.Protocols.POP]={server:"pop3.arcor.de",tpl:"login"},Me.teaser="yahoo",Me),(Se={name:["bbox.fr"],useProtocol:uo.Protocols.IMAP},Se[uo.Protocols.IMAP]={server:"imap.bbox.fr"},Se[uo.Protocols.POP]={server:"pop3.bbox.fr"},Se.teaser="yahoo",Se),(Ce={name:["bouygtel.fr"],useProtocol:uo.Protocols.IMAP},Ce[uo.Protocols.IMAP]={server:"imap.bouygtel.fr"},Ce[uo.Protocols.POP]={server:"pop.bouygtel.fr"},Ce.teaser="yahoo",Ce),(Ie={name:["caramail.com"]},Ie[uo.Protocols.IMAP]=null,Ie[uo.Protocols.POP]={server:"pop.lycos.co.uk"},Ie.teaser="yahoo",Ie),(ke={name:["cegetel.fr","cegetel.net"]},ke[uo.Protocols.IMAP]={server:"imap.cegetel.net"},ke[uo.Protocols.POP]=null,ke.useProtocol=uo.Protocols.IMAP,ke.teaser="yahoo",ke),(Ae={name:["club-internet.fr","club-internet.net"]},Ae[uo.Protocols.IMAP]=null,Ae[uo.Protocols.POP]={server:"pop3.club-internet.fr"},Ae.teaser="yahoo",Ae),(Fe={name:["email.de"]},Fe[uo.Protocols.IMAP]=null,Fe[uo.Protocols.POP]={server:"pop3.web.de"},Fe.teaser="yahoo",Fe),(Oe={name:["fastwebnet.it"]},Oe[uo.Protocols.IMAP]=null,Oe[uo.Protocols.POP]={server:"pop.fastwebnet.it"},Oe.teaser="yahoo",Oe),(Le={name:["free.fr"],useProtocol:uo.Protocols.IMAP},Le[uo.Protocols.IMAP]={server:"imap.free.fr",tpl:"login"},Le[uo.Protocols.POP]={server:"pop.free.fr",tpl:"login"},Le.teaser="yahoo",Le),(De={name:["freenet.de"],useProtocol:uo.Protocols.IMAP},De[uo.Protocols.IMAP]={server:"mx.freenet.de"},De[uo.Protocols.POP]={server:"mx.freenet.de"},De.teaser="yahoo",De),(Ee={name:["gmx.de","gmx.net","gmx.at","gmx.ch","gmx.eu","gmx.biz","gmx.org","gmx.info"],useProtocol:uo.Protocols.IMAP},Ee[uo.Protocols.IMAP]={server:"imap.gmx.net"},Ee[uo.Protocols.POP]={server:"pop.gmx.net"},Ee.teaser="yahoo",Ee),(xe={name:["googlemail.com"],useProtocol:uo.Protocols.IMAP},xe[uo.Protocols.IMAP]={server:"imap.googlemail.com"},xe[uo.Protocols.POP]={server:"pop.googlemail.com"},xe.teaser="yahoo",xe),(Be={name:["laposte.net"],useProtocol:uo.Protocols.IMAP},Be[uo.Protocols.IMAP]={server:"imap.laposte.net",tpl:"login"},Be[uo.Protocols.POP]={server:"pop.laposte.net",tpl:"login"},Be.teaser="yahoo",Be),(Ue={name:["libero.it","iol.it","blu.it","inwind.it"],useProtocol:uo.Protocols.IMAP},Ue[uo.Protocols.IMAP]={server:"imapmail.libero.it"},Ue[uo.Protocols.POP]={server:"popmail.libero.it"},Ue.useSSL=!1,Ue.teaser="yahoo",Ue),(Te={name:["lybertysurf.fr"]},Te[uo.Protocols.IMAP]=null,Te[uo.Protocols.POP]={server:"pop.libertysurf.fr"},Te.teaser="yahoo",Te),(je={name:["lycos.co.uk"]},je[uo.Protocols.IMAP]=null,je[uo.Protocols.POP]={server:"pop.lycos.co.uk",tpl:"login"},je.teaser="yahoo",je),(Ne={name:["netcourrier.com"]},Ne[uo.Protocols.IMAP]=null,Ne[uo.Protocols.POP]={server:"mail.netcourrier.com"},Ne.teaser="yahoo",Ne),(Re={name:["neuf.fr","sfr.fr"],useProtocol:uo.Protocols.IMAP},Re[uo.Protocols.IMAP]={server:"imap.sfr.fr"},Re[uo.Protocols.POP]={server:"pop.sfr.fr"},Re.useSSL=!1,Re.teaser="yahoo",Re),(Ve={name:["noos.fr"]},Ve[uo.Protocols.IMAP]=null,Ve[uo.Protocols.POP]={server:"pop.noos.fr"},Ve.teaser="yahoo",Ve),(We={name:["o2online.de"]},We[uo.Protocols.IMAP]=null,We[uo.Protocols.POP]={server:"pop.o2online.de"},We.teaser="yahoo",We),($e={name:["orange.fr"],useProtocol:uo.Protocols.IMAP},$e[uo.Protocols.IMAP]={server:"imap.orange.fr",tpl:"login"},$e[uo.Protocols.POP]={server:"pop.orange.fr",tpl:"login"},$e.useSSL=!1,$e.teaser="yahoo",$e),(He={name:["wanadoo.fr"],useProtocol:uo.Protocols.IMAP},He[uo.Protocols.IMAP]={server:"imap.wanadoo.fr"},He[uo.Protocols.POP]={server:"pop.wanadoo.fr"},He.teaser="yahoo",He),(ze={name:["tele2.fr"]},ze[uo.Protocols.IMAP]=null,ze[uo.Protocols.POP]={server:"pop.tele2.fr"},ze.teaser="yahoo",ze),(Ke={name:["telefonica.net"]},Ke[uo.Protocols.IMAP]={server:"imap.telefonica.net"},Ke[uo.Protocols.POP]=null,Ke.useProtocol=uo.Protocols.IMAP,Ke.teaser="yahoo",Ke),(Je={name:["terra.es"],useProtocol:uo.Protocols.IMAP},Je[uo.Protocols.IMAP]={server:"imap4.terra.es"},Je[uo.Protocols.POP]={server:"pop3.terra.es"},Je.useSSL=!1,Je.teaser="yahoo",Je),(qe={name:["tim.it"]},qe[uo.Protocols.IMAP]={server:"easyimap4.posta.tim.it"},qe[uo.Protocols.POP]=null,qe.useProtocol=uo.Protocols.IMAP,qe.teaser="yahoo",qe),(Xe={name:["tin.it"]},Xe[uo.Protocols.IMAP]=null,Xe[uo.Protocols.POP]={server:"box.tin.it"},Xe.teaser="yahoo",Xe),(Ye={name:["tiscali.fr"],useProtocol:uo.Protocols.IMAP},Ye[uo.Protocols.IMAP]={server:"imap.tiscali.fr"},Ye[uo.Protocols.POP]={server:"pop.tiscali.fr"},Ye.teaser="yahoo",Ye),(Ge={name:["tiscali.it"],useProtocol:uo.Protocols.IMAP},Ge[uo.Protocols.IMAP]={server:"imap.tiscali.it"},Ge[uo.Protocols.POP]={server:"pop.tiscali.it"},Ge.teaser="yahoo",Ge),(Qe={name:["tre.it"]},Qe[uo.Protocols.IMAP]={server:"imap.tre.it"},Qe[uo.Protocols.POP]=null,Qe.useProtocol=uo.Protocols.IMAP,Qe.teaser="yahoo",Qe),(Ze={name:["virgilio.it"]},Ze[uo.Protocols.IMAP]=null,Ze[uo.Protocols.POP]={server:"in.virgilio.it",tpl:"login"},Ze.teaser="yahoo",Ze),(eo={name:["vodafone.de"]},eo[uo.Protocols.IMAP]=null,eo[uo.Protocols.POP]={server:"pop.email.vodafone.de"},eo.teaser="yahoo",eo),(oo={name:["vodafone.it"]},oo[uo.Protocols.IMAP]=null,oo[uo.Protocols.POP]={server:"popmail.vodafone.it"},oo.teaser="yahoo",oo),(to={name:["email.ua"]},to[uo.Protocols.IMAP]={server:"imap.email.ua"},to[uo.Protocols.POP]={server:"pop.email.ua"},to),(ro={name:["3g.ua"]},ro[uo.Protocols.IMAP]=null,ro[uo.Protocols.POP]={server:"pop.3g.ua"},ro),(no={name:["mail.ua"],useProtocol:uo.Protocols.IMAP},no[uo.Protocols.IMAP]={server:"imap.mail.ru"},no[uo.Protocols.POP]={server:"pop.mail.ru"},no.useSSL=!0,no),(so={name:["a.ua"],useProtocol:uo.Protocols.IMAP},so[uo.Protocols.IMAP]={server:"imap.a.ua"},so[uo.Protocols.POP]={server:"pop.a.ua"},so),(io={name:["ukrpost.net"],useProtocol:uo.Protocols.IMAP},io[uo.Protocols.IMAP]={server:"mail.ukrpost.ua"},io[uo.Protocols.POP]={server:"mail.ukrpost.ua"},io),(ao={name:["online.ua"]},ao[uo.Protocols.IMAP]=null,ao[uo.Protocols.POP]={server:"pop3.online.ua"},ao.useSSL=!1,ao),(lo={name:["meta.ua"]},lo[uo.Protocols.IMAP]=null,lo[uo.Protocols.POP]={server:"pop.meta.ua"},lo.useSSL=!0,lo),(co={name:["tut.by"],useProtocol:uo.Protocols.IMAP},co[uo.Protocols.IMAP]={server:"imap.yandex.ru"},co[uo.Protocols.POP]={server:"pop.yandex.ru"},co.useSSL=!0,co)]},4023:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.Protocols=void 0;!(function(e){e.IMAP="imap",e.POP="pop"})(o.Protocols||(o.Protocols={}))},4024:function(e,o){!(function(){ns.Model.define("collectors",{params:{no_cache:null},split:{items:".",params:{popid:".popid"},model_id:"collector"},methods:{getMasterRequest:function(){var e=this,o=ns.Model.get(this.id,_.assign({},this.params,{no_cache:1}));return o.destroy(),o.once("ns-model-changed",(function(){e.setData(this.getData())})),o},getData:function(){return this.data||[]},exists:function(e){return this.models.some((function(o){return o.get(".email")===e}))},getById:function(e){return ns.Model.get("collector",{popid:e}).getData()},getCount:function(){return this.models.length}}})})()},4025:function(e,o){ns.Model.define("collector",{events:{"ns-model-changed":"onModelChanged"},params:{popid:null},methods:{preprocessData:function(e){e.body&&(e=e.body);var o=e.email;if(!o)if(_.contains(e.login,"@"))o=e.login;else{var t=ns.Model.get("collector-settings").getByServer(e.server);o=t?e.login+"@"+t.name:e.login}return e.email=o,e},markJustCreated:function(){this.set(".justCreated",!0)},onModelChanged:function(){var e=this.getData();e.last_connect&&(e.human_time=Jane.Date.humanDate(new Date(1e3*e.last_connect)))}}})},4026:function(e,o){ns.Model.define("do-folder-clear",{params:{fid:null,method:null,old_f:null,from_f:null,subj_f:null}})},4027:function(e,o){ns.Model.define("do-folder-create-hidden-trash",{})},4028:function(e,o){ns.Model.define("do-folder-mark-read",{params:{fid:null,tabId:null}})},4029:function(e,o){ns.Model.define("do-folder-move",{params:{fid:null,parent_id:null}})},4030:function(e,o){ns.Model.define("do-folder-purge-hidden-trash",{})},4031:function(e,o){ns.Model.define("do-folder-rename",{params:{fname:null,fid:null,parent_id:null}})},4032:function(e,o){ns.Model.define("do-folder-set-options",{params:{fid:null,prev:null}})},4033:function(e,o){ns.Model.define("do-folder-set-symbol",{params:{fid:null,symbol:null}})},4034:function(e,o){ns.Model.define("do-folders-add",{params:{folder_name:null,parent_id:null,symbol:null},methods:{getFid:function(){return this.get(".body.updated")}}})},4035:function(e,o){ns.Model.define("do-labels-add",{params:{label_name:null,label_color:null,label_type:null}})},4036:function(e,o){ns.Model.define("do-labels-add-by-symbol",{params:{symbol:null}})},4037:function(e,o){ns.Model.define("do-label",{params:{lid:null,ids:null,tids:null,fid:null,tabId:null},methods:{getAffectedTids:function(){return this.select('.thread[.lid == "'+this.params.lid+'"].tid')}}})},4038:function(e,o){ns.Model.define("do-unlabel",{params:{lid:null,ids:null,tids:null,fid:null,tabId:null},methods:{getAffectedTids:function(){return this.select('.thread[.lid != "'+this.params.lid+'"].tid')}}})},4039:function(e,o){function t(e,o){return s(e)||n(e,o)||r()}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function n(e,o){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var t=[],r=!0,n=!1,s=void 0;try{for(var i,a=e[Symbol.iterator]();!(r=(i=a.next()).done)&&(t.push(i.value),!o||t.length!==o);r=!0);}catch(e){n=!0,s=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw s}}return t}}function s(e){if(Array.isArray(e))return e}function i(e,o,t,r,n,s,i){try{var a=e[s](i),l=a.value}catch(e){return void t(e)}a.done?o(l):Promise.resolve(l).then(r,n)}function a(e){return function(){var o=this,t=arguments;return new Promise(function(r,n){function s(e){i(l,r,n,s,a,"next",e)}function a(e){i(l,r,n,s,a,"throw",e)}var l=e.apply(o,t);s(void 0)})}}ns.Model.define("tab",{params:{id:null},methods:{request:(function(){function e(){return o.apply(this,arguments)}var o=a(regeneratorRuntime.mark((function e(){var o,r,n,s,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ns.request(["tabs"]);case 2:o=e.sent,r=t(o,1),n=r[0],s=n.getTabs().find((function(e){return e.id===i.params.id})),s&&this.setData(s);case 7:case"end":return e.stop()}}),e,this)})));return e})(),getUnreadCount:function(){return this.get(".counters.new")||0},getCount:function(){return this.get(".counters.all")},_setUnreadCount:function(e){return this.set(".counters.new",e)},getRecent:function(){return this.get(".counters.recent")},setRecent:function(){this.setIfChanged(".counters.recent",!0)},clearRecent:function(){delete this.getData().counters.recent},adjustUnreadCount:function(e){var o=this.getUnreadCount(),t=Math.max(Number(o)+Number(e),0);o!==t&&this._setUnreadCount(t)}}})},4040:function(e,o,t){"use strict";var r=[{id:"relevant",title:i18n("%Folder_tabs_Inbox"),description:"",iconName:"mail--NewTabs-Default",emptyText:i18n("%Empty_tab_inbox")},{id:"news",title:i18n("%Folder_tabs_News"),description:i18n("%Folder_tabs_News_descr"),iconName:"mail--NewTabs-News",emptyText:i18n("%Empty_tab_maillists")},{id:"social",title:i18n("%Folder_tabs_Social"),description:i18n("%Folder_tabs_Social_descr"),iconName:"mail--NewTabs-Social",emptyText:i18n("%Empty_tab_social")}];ns.Model.define("tabs",{split:{items:".tabs",params:{id:".id"},model_id:"tab"},methods:{preprocessData:function(e){return{tabs:r.map((function(o){return Object.assign({},o,e[o.id])}))}},getTab:function(e){var o=ns.Model.get("tab",{id:e});return o.isValid()?o:null},getTabs:function(){return this.models.slice()},getFoldersTabsList:function(){return this.models.map((function(e){return e.getData()}))},getFoldersTabsIds:function(){return r.map((function(e){return e.id}))},getUnreadCount:function(e){var o=this.getTab(e);return o?o.getUnreadCount():0},adjustUnreadCounters:function(e){var o=this;return Object.keys(e).reduce((function(t,r){var n=o.getTab(r);if(n){var s=e[r];return n.adjustUnreadCount(s),t+s}return t}),0)}}})},4041:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=t(135);t.n(r);ns.Model.define("folder",{params:{fid:null},methods:{preprocessData:function(e){if(Daria.IS_CORP&&this.data){["new","count"].some((function(o){return this.get("."+o)!==e[o]}),this)&&this._messagesInvalidate()}return e},hasDataChanged:function(e){return!_.isEqual(this.getData(),e)},getRecent:function(){return this.get(".recent")},adjustUnreads:function(e){if(this.isValid()){var o=this.getUnreadsCount(),t=Math.max(o+e,0);t!==o&&(this.set(".new",t),this.setHasUnread(t>0))}},getParent:function(){var e=this.get(".parent_id");return e?ns.Model.get("folder",{fid:e}):null},getUnreadsCount:function(){return this.get(".new")},getSubfolders:function(){return this.get(".subfolder")},hasUnreads:function(){return this.getUnreadsCount()>0},hasUnreadsDeep:function(){return this.get(".has-unread")||this.hasUnreads()},hasNestingToggler:function(){var e=this.getSubfolders();if(!e||!e.length)return!1;var o=!0;if(ns.Model.get("settings").getSetting("hide_empty_folders")&&this.hasUnreads()){var t=!1;e.forEach((function(e){t=t||!ns.Model.get("folders").isIncoming(e)||ns.Model.get("folder",{fid:e}).hasUnreads()})),t||(o=!1)}return o},isFolded:function(){return this.get(".folded")},isOpen:function(){return this.get(".opened")},updateCounts:function(e){if(this.isValid()){var o={};if(_.isNumber(e.count)){var t=this.get(".count"),r=e.count;o.count=r-t,0!==o.count&&this.set(".count",r)}if(_.isNumber(e.new)){var n=this.getUnreadsCount(),s=e.new;if(o.new=s-n,0!==o.new){this.set(".new",s);var i=ns.Model.get("folders");i.spamOrTrash(this.params.fid)||i.adjustAllUnreads(o.new)}}return o}},recalcOpened:function(){var e=ns.Model.get("folders").isFolder(this.get(".fid"),r.WellKnownFolderSymbol.ARCHIVE);if(Daria.areFoldersTabsEnabled()&&e)return void this.setIfChanged(".opened",!0);var o=this.getParent();if(o){var t=!0;o.isFolded()&&(t=!1),o.isOpen()||(t=!1),this.set(".opened",t),this._toggleSubfoldersOpened()}},setHasUnread:function(e){var o=e||this.hasUnreads();o||this.getSubfolders().forEach((function(e){var t=ns.Model.get("folder",{fid:e}).get(".has-unread");o=o||t})),this.setIfChanged(".has-unread",o);var t=this.getParent();t&&t.get(".symbol")!==r.WellKnownFolderSymbol.INBOX&&t.setHasUnread(e)},setRecent:function(){this.setIfChanged(".recent",!0)},switchFolded:function(e){var o=this.getData(),t=this.get(".fid");if(!this.getSubfolders().length)return!1;var r=ns.Model.get("folders"),n=r.getOpenedFolders(),s=o.folded;if(_.isBoolean(e)){if(e===s)return s;s=!e}return Jane.Array.remove(n,t),s?(this.set(".folded",!1),n.push(t)):this.set(".folded",!0),ns.Model.get("settings").setOpenedFolders(n),this._toggleSubfoldersOpened(),!s},_toggleSubfoldersOpened:function(){this.getSubfolders().forEach((function(e){ns.Model.get("folder",{fid:e}).recalcOpened()}))},_messagesInvalidate:function(){var e=this.params.fid;ns.page.current.params.current_folder!==e&&(ns.Model.invalidate("messages",(function(o){if(o.params.current_folder===e)return o.models.length&&o.models.forEach((function(e){ns.Model.get("messages",{thread_id:e.get(".tid")}).invalidate()})),!0})),ns.Model.invalidate("messages-item-state",(function(o){return o.params.current_folder===e})))}}})},4042:function(e,o,t){"use strict";function r(e){return i(e)||s(e)||n()}function n(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function s(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function i(e){if(Array.isArray(e)){for(var o=0,t=new Array(e.length);o<e.length;o++)t[o]=e[o];return t}}function a(e){"@babel/helpers - typeof";return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}Object.defineProperty(o,"__esModule",{value:!0});var d=t(135);t.n(d);!(function(){function e(){return d.SystemFolders.slice()}function o(e,t){var r=e[t.parent_id];return r.parent_id?o(e,r):r}var t,n={},s=(t={},l(t,d.WellKnownFolderSymbol.INBOX,i18n("%Folder_inbox")),l(t,d.WellKnownFolderSymbol.SENT,i18n("%Folder_sent")),l(t,d.WellKnownFolderSymbol.TRASH,i18n("%Folder_trash")),l(t,d.WellKnownFolderSymbol.SPAM,i18n("%Folder_spam")),l(t,d.WellKnownFolderSymbol.DRAFT,i18n("%Folder_draft")),l(t,d.WellKnownFolderSymbol.OUTBOX,i18n("%Folder_outbox")),l(t,d.WellKnownFolderSymbol.TEMPLATE,i18n("%Folder_templates")),l(t,d.WellKnownFolderSymbol.ARCHIVE,i18n("%Folder_archive")),l(t,d.WellKnownFolderSymbol.RESTORED,i18n("%Folder_restored")),t);n.getFolderById=function(e){return ns.Model.get("folder",{fid:e}).getData()},n.getFoldersByName=function(e){var o;return"object"===a(this.data)&&(o=_.find(this.data.folder,(function(o){return o.name===e}))),[o]},n.getSubfolders=function(e){return jpath(this.data,'.folder[.parent_id == "'+e+'"]')},n.isPresentAndNotShared=function(e){return Boolean(jpath(this.data,'.folder[.fid == "'+e+'" && !.shared ]').length)},n.getSubfoldersFid=function(e){return $.map(this.getSubfolders(e)||[],(function(e){return e.fid}))},n.getAllSubfoldersFid=function(e){return function e(o){for(var t=this.getSubfoldersFid(o),r=t.length;r--;)t=t.concat(e.call(this,t[r]));return t}.call(this,e)},n.getInboxFolders=function(){var e=this.get(".folder"),t=e[0].fid,r=e.reduce((function(e,o){return e[o.fid]=o,e}),{}),n=e.reduce((function(e,t){return e[t.fid]=t.parent_id?o(r,t).fid:t.fid,e}),{});return Object.keys(n).filter((function(e){return n[e]===t&&!r[e].shared}))},n.spamOrTrash=function(e){return this.isFolder(e,[d.WellKnownFolderSymbol.TRASH,d.WellKnownFolderSymbol.SPAM])},n.isIncoming=function(e){return!this.isFolder(e,d.NotIncoming)},n.isSystemFolder=function(o){var t=this.getFolderById(o);return!!t&&(!t.user&&this.isFolder(o,e()))},n.isSystemFolderChild=function(o,t){var r=this,n=this.getFolderById(o);if(!n||!n.user||this.isSystemFolder(o))return!1;var s=e(),i="function"==typeof t?s.filter(t):s;return!!i.length&&i.some((function(e){return r.hasChildByFid(r.getFidBySymbol(e),o)}))},n.getDroppableListFid=function(){var e=this,o=$.grep(this.get(".folder"),(function(o){return e.isDroppable(o.fid)}));return o=$.map(o,(function(e){return e.fid}))},n.getMoveFoldersFid=function(e){if(!this.isDraggable(e))return[];var o=this.getDroppableListFid(),t=this.getAllSubfoldersFid(e);return t=t.concat(e),o=$.grep(o,(function(e){return-1===$.inArray(e,t)}))},n.comparePosition=function(e,o){var t=!e.symbol&&e.user,r=!o.symbol&&o.user,n=e.name.toLowerCase(),s=o.name.toLowerCase(),i=e.folder_options.position,a=o.folder_options.position,l=t?i:1e12+Number(e.order||0),c=r?a:1e12+Number(o.order||0);return e.symbol===d.WellKnownFolderSymbol.INBOX&&(l=-1),o.symbol===d.WellKnownFolderSymbol.INBOX&&(c=-1),l<c?-1:l>c?1:n<s?-1:n>s?1:0},n.getNeighborFids=function(e){var o=e&&this.getFolderById(e);if(!o)return[];var t;return t=o.parent_id?this.getSubfolders(o.parent_id):$.grep(this.get(".folder"),(function(e){return!e.parent_id&&e.user&&!e.symbol})),t.sort(this.comparePosition),$.map(t,(function(e){return e.fid}))},n.getParentFid=function(e){var o=e&&this.getFolderById(e);return o&&o.parent_id||this.getFolderBySymbol(d.WellKnownFolderSymbol.INBOX).fid},n.getTopParent=function(e){for(var o=this.getFolderById(this.getParentFid(e));o&&!o.symbol;)o=this.getFolderById(this.getParentFid(o.fid));return o},n.isDroppable=function(e){var o=e&&this.getFolderById(e);if(!o)return!1;var t=this.getTopParent(e);return!(!t||t.symbol!==d.WellKnownFolderSymbol.INBOX)&&(o.user&&!o.symbol&&!o.shared||o.symbol===d.WellKnownFolderSymbol.INBOX)},n.isDraggable=function(e){var o=e&&this.getFolderById(e);if(!o)return!1;var t=this.getTopParent(e);return!(!t||t.symbol!==d.WellKnownFolderSymbol.INBOX)&&(o.user&&!o.symbol&&!o.shared)},n.moveIn=function(e,o){var t=$.Deferred();if(e===o)return t.resolve("donot"),t.promise();var r=this.getFolderById(e),n=this.getParentFid(e),s=this.getFolderById(o);if(!r||!s)return t.reject("notfound"),t.promise();if(!this.isDraggable(e)||!this.isDroppable(o))return t.reject("noaccess"),t.promise();if(n===o)return t.resolve("donot"),t.promise();var i;i=o?this.getSubfolders(o):$.grep(this.get(".folder"),(function(e){return!e.parent_id}));for(var a=0;a<i.length;a++)if(i[a].name===r.name)return t.reject("nameduplicate"),t.promise();return this.getFolderBySymbol(d.WellKnownFolderSymbol.INBOX).fid===o&&(o=0),ns.forcedRequest([{id:"do-folder-move",params:{fid:e,parent_id:o}},{id:"folders"}]).then((function(){t.resolve("ok")}),(function(){t.reject("actionerror")})),t.promise()},n.moveAfter=function(e,o){var t=$.Deferred();if(e===o)return t.resolve("donot"),t.promise();var r=this.getFolderById(e);if(!r||!$.isPlainObject(r.folder_options))return t.reject("notfound"),t.promise();if(!this.isDraggable(e))return t.reject("noaccessfid"),t.promise();var n,s=$({}),i=this;if(o){if(!this.isDroppable(o))return t.reject("noaccessover"),t.promise();var a=this.getParentFid(e),l=this.getParentFid(o);if(a!==l)s.queue((function(o){i.moveIn(e,l).done(o).fail(t.reject)}));else if(n=this.getNeighborFids(e),$.inArray(e,n)===$.inArray(o,n)+1)return t.resolve("donot"),t.promise()}else if(n=this.getNeighborFids(e),0===$.inArray(e,n))return t.resolve("donot"),t.promise();return s.queue((function(){ns.forcedRequest([{id:"do-folder-set-options",params:{fid:e,prev:o||0}},{id:"folders"}]).then((function(){t.resolve("ok");var r=i.getNeighborFids(o||e),n=$.inArray(e,r),s=$.inArray(o,r);(o&&n!==s+1||!o&&0!==n)&&Jane.ErrorLog.send({event:"folders.move.position",status:"position_error",fid:e+":"+i.getFolderById(e).folder_options.position,overFid:o?o+":"+i.getFolderById(o).folder_options.position:void 0})}),(function(){t.reject("actionerror")}))})),t.promise()},n.moveBefore=function(e,o){var t=$.Deferred(),r=this.getNeighborFids(o),n=r[$.inArray(o,r)-1];if(n)this.moveAfter(e,n).done(t.resolve).fail(t.reject);else{var s=$({}),i=this,a=this.getParentFid(o);s.queue((function(o){i.moveIn(e,a).done(o).fail(t.reject)})),s.queue((function(){i.moveAfter(e,!1).done(t.resolve).fail(t.reject)}))}return t.promise()},n.getCount=function(e){var o=this.getFolderById(e);return o?o.count:null},n.getUnreadCount=function(e){var o=e?this.getFolderById(e):this.data;return o?Number(o.new):null},n.getFoldersHash=function(){var e=this.getData(),o={};return e&&$.each(e.folder,(function(){o[this.fid]=0})),o},n.isShared=function(e){var o=this.getFolderById(e);return Boolean(o&&o.shared)},n.getDefaultFolderName=function(e){return s[e]},n.setSymbol=function(e,o){var t=[{id:"do-folder-set-symbol",params:{fid:e,symbol:o}},{id:"folders"}];return ns.forcedRequest(t).then((function(e){var t=Vow.promise(),r=e[1].getFolderBySymbol(o);return r?(ns.events.trigger("daria:mFolders:symbolSet",r),t.fulfill(r)):t.reject(new Error(Daria.supplant("Symbol {symbol} was not set on folder",{symbol:o}))),t}))},n.isArchive=function(e){var o=this.getFolderById(e);return!!o&&o.symbol===d.WellKnownFolderSymbol.ARCHIVE},n.getCountUserFolders=function(){return jpath(this.data,".folder[.user]").length},n.createArchiveFolder=function(){var e,o=this,t=o.getFolderBySymbol(d.WellKnownFolderSymbol.ARCHIVE),r=o.getFoldersByName("Archive").shift(),n="Archive"!==i18n("%Folder_archive")?o.getFoldersByName(i18n("%Folder_archive")).shift():null,s=Vow.promise();return t||r||n?t||!r&&!n?s.fulfill(t):r?s=o.setSymbol(r.fid,d.WellKnownFolderSymbol.ARCHIVE):n&&(e=[{id:"do-folder-rename",params:{fname:"Archive",fid:n.fid}},{id:"folders"}],s=ns.forcedRequest(e).then((function(){return o.setSymbol(n.fid,d.WellKnownFolderSymbol.ARCHIVE).fail((function(){}))}))):(e=[{id:"do-folders-add",params:{folder_name:"Archive"}},{id:"folders"}],s=ns.forcedRequest(e).then((function(e){var o=Vow.promise(),t=e[1],r=t.getFolderByName("Archive");return r&&r.fid?o.fulfill(r):o.reject("New folder has no fid"),o})).then((function(e){return o.setSymbol(e.fid,d.WellKnownFolderSymbol.ARCHIVE).fail((function(){}))}))),s},n.getHierarchyStructure=function(e,o,t){function n(o){var t=[];o=o.sort(s.comparePosition);for(var r=0;r<o.length;++r){var a=o[r];_.isFunction(e)&&!e(a)||(a=_.clone(a),a.subfolder&&(a.items=n(a.subfolder.map(i))),delete a.subfolder,delete a.parent_id,t.push(a))}return t}var s=this,i=this.getFolderById.bind(this),a=this.get(".folder");_.find(a,{symbol:d.WellKnownFolderSymbol.INBOX}).items=n(_.filter(a,(function(e){return e.user&&!e.parent_id})));var l=_.filter(a,(function(e){return!e.user&&!e.parent_id})),c=n(l);if(o){var u=_.findIndex(c,{symbol:d.WellKnownFolderSymbol.INBOX}),f=c[u].items,m=l.slice(0,u),h=l.slice(u+1);c=t?r(f):[].concat(r(m),r(f),r(h))}return c},n.logDragndropAbility=function(){var e=this.get(".folder");if(e)for(var o=0,t=0,r=e.length;t<r;t++)if(this.isDraggable(e[t].fid)&&++o>1)return void Jane.c("Drag-n-drop","Драгндроп папок","Показ папок в инбоксе (больше 1, драг разрешен)")},ns.Model.define("folders",{split:{items:".folder",params:{fid:".fid"},model_id:"folder"},methods:$.extend({_ids:{},_symbols:{},_cacheBySymbol:{},preprocessData:function(e){this._hasUserFolders=!1,this._hasNestedFolders=!1;for(var o=ns.page.current.params.current_folder,t={},r={},n={},i=e.folder,a={},l=this._getOpenedFolders(e),c=0,u=i.length;c<u;c++){var f=i[c],m=f.fid,h=f.symbol;a[m]=f;var p=o&&m!==o,g=this.getFolderById(m),v=g&&f.count!==g.count;p&&v&&Daria.messages.clearCacheByFID(m),h&&(h in s&&(f.name=s[h]),t[h]=m,r[h]=f,n[m]=h),!this._hasUserFolders&&f.user&&(this._hasUserFolders=!0),this._hasNestedFolders||!f.user&&!f.parent_id||(this._hasNestedFolders=!0),f.subfolder.length>0?f.folded=!_.includes(l,m):f.folded=!1,f.opened=!0;var P=Daria.areFoldersTabsEnabled()&&f.symbol===d.WellKnownFolderSymbol.ARCHIVE;if(f.parent_id&&!P){var b=a[f.parent_id];b.folded&&(f.opened=!1),b.opened||(f.opened=!1)}}return this._ids=t,this._cacheBySymbol=r,this._symbols=n,this.toggleMarkFolders(e),e},_getOpenedFolders:function(e){return ns.Model.get("settings").hasSetting("folders_open")?this._getOpenedFoldersFromSettings():this._getOpenedFoldersFromData(e)},_getOpenedFoldersFromSettings:function(){var e=ns.Model.get("settings").getSetting("folders_open");return e?e.split(","):[]},_getOpenedFoldersFromData:function(e){var o=[];return e.folder.forEach((function(e){[d.WellKnownFolderSymbol.INBOX,d.WellKnownFolderSymbol.DRAFT].includes(e.symbol)&&o.push(e.fid),e.subfolder.length&&Array.prototype.push.apply(o,e.subfolder)})),_.uniq(o)},getOpenedFolders:function(){return this._getOpenedFolders(this.data)},symbols:function(){return this._ids},ids:function(){return this._symbols},hasUserFolders:function(){return this._hasUserFolders},hasNestedFolders:function(){return this._hasNestedFolders},getFolderByName:function(e,o){var t,r=this.getData();if(r){var n;o||(n=this.getFidBySymbol(d.WellKnownFolderSymbol.INBOX)),t=_.find(r.folder,(function(t){return t.name===e&&(o?t.parent_id===o:!t.parent_id||t.parent_id===n)}))}return t},getFolderBySymbol:function(e){return this._cacheBySymbol[e]},getFidBySymbol:function(e){return this._ids[e]},isFolder:function(e,o){if(!e)return!1;Array.isArray(o)||(o=[o]);for(var t=0,r=o.length;t<r;t++){var n=o[t];if(this._ids.hasOwnProperty(n)&&e===this._ids[n])return!0}return!1},isCurrentFolder:function(e){return this.isFolder(ns.page.current.params.current_folder,e)},createTemplateFolder:function(){var e,o=Vow.promise(),t=this.getFolderBySymbol(d.WellKnownFolderSymbol.TEMPLATE),r=this.getFidBySymbol(d.WellKnownFolderSymbol.DRAFT),n=this.getSubfolders(r),i=_.find(n,(function(e){return"template"===e.name})),a=_.find(n,(function(e){return e.name===s.template}));return t||i||a?t||!i&&!a?o.fulfill(t):i?o=this.setSymbol(i.fid,d.WellKnownFolderSymbol.TEMPLATE):a&&(e=[{id:"do-folder-rename",params:{fname:"template",fid:a.fid,parent_id:r}},{id:"folders"}],o=ns.forcedRequest(e).then(function(){return this.setSymbol(a.fid,d.WellKnownFolderSymbol.TEMPLATE)}.bind(this))):(e=[{id:"do-folders-add",params:{folder_name:"template",parent_id:r}}],o=ns.forcedRequest(e).then(function(e){var o=e[0];return this.setSymbol(o.getFid(),d.WellKnownFolderSymbol.TEMPLATE)}.bind(this))),o},adjustUnreadCounters:function(e){var o=!1,t=0;for(var r in e){var n=ns.Model.get("folder",{fid:r});n.adjustUnreads(e[r]),-1===d.UnreadHiddenFoldersShort.indexOf(n.get(".symbol"))&&(t+=e[r],o=!0)}return o&&this.adjustAllUnreads(t),o},toggleMarkFolders:function(e){var o={};$.each(jpath(e,".folder[.parent_id && !.subfolders]"),(function(t,r){var n,s=0;do{if(r=n?jpath(e,'.folder[.fid == "'+n+'"]')[0]:r,r.symbol===d.WellKnownFolderSymbol.INBOX)return!0;if(s+=Number(r.new),n in o)return!0;s?(r["has-unread"]=!0,o[r.fid]=1):r["has-unread"]=!1,n=r.parent_id}while(n)}))},hasChildByFid:function(e,o){var t=this.getFolderById(e),r=t&&t.subfolder?t.subfolder:[],n=0!==r.length&&r.indexOf(o)>-1,s=this;return _.forEach(r,(function(e){n=n||s.hasChildByFid(e,o)})),n},adjustAllUnreads:function(e){var o=this.get(".new"),t=Math.max(o+e,0);o!==t&&this.set(".new",t)}},n)})})()},4043:function(e,o){ns.Model.define("messages-filters",{events:{"ns-model-init":"_onInit","ns-model-destroyed":"_onDestroy"},ctor:function(){this._onPageBeforeLoad=this._onPageBeforeLoad.bind(this)},methods:{_onInit:function(){this.setData({}),this._onLoad(ns.page.current.params),ns.events.on("ns-page-before-load",this._onPageBeforeLoad)},_onDestroy:function(){ns.events.off("ns-page-before-load",this._onPageBeforeLoad)},_onPageBeforeLoad:function(e,o){this._onLoad(o[1].params)},_onLoad:function(e){var o,t=ns.Model.get("labels"),r=e.current_label===t.getImportantLID();o=e.important||r?"important":e.attachments?"attachments":e.unread?"unread":"inbox";var n=ns.Model.get("labels").getWaitingForReplyLabel();e.current_label&&e.current_label===n.lid&&(o="wait"),this.setIfChanged(".filter",o)}}},ns.ModelStatic)},4044:function(e,o){ns.Model.define("label",{events:{"ns-model-changed.count":"_onChangedCount"},params:{lid:null},methods:{_onChangedCount:function(){if(this.data&&this.data.hasOwnProperty("unused")){var e=this.get(".count");this.setIfChanged(".unused",!e,{silent:!0})}},getUnreadCount:function(){return this.get(".unreadCount")||0},adjustUnreadCount:function(e){var o=this.getUnreadCount(),t=Math.max(o+e,0);this.setIfChanged(".unreadCount",t)}}})},4045:function(e,o){!(function(){ns.Model.define("labels",{split:{items:".label",params:{lid:".lid"},model_id:"label"},methods:{_cacheByLid:{},_cacheByName:{},_cacheUserLabelsByName:{},LABEL_PINNED_SYMBOL_NAME:"pinned_label",LABEL_MUTE_SYMBOL_NAME:"mute_label",LABEL_PHISHING_NAME:"73",preprocessData:function(e){return this._cacheByName={},this._cacheUserLabelsByName={},this._cacheByLid={},this.sortLabels(e.label),e.label.forEach((function(e){var o,t=e.name,n=r[t];n?("dating"===n?o=i18n("%Labels_Social_Label_Datingsite"):"groupon"===n?o=i18n("%Labels_Social_Label_Grouponsite"):"yasupport"===n?(o=i18n("%Labels_Social_Label_Yasupport"),e.yaservice=!0):"videoletter"===n?(o=i18n("%Labels_Social_Label_Videoletter"),e.yaservice=!0):"eticket"===n?o=i18n("%Labels_Social_Label_Eticket"):t.indexOf("ya")>-1||"moikrug"===t?(o=i18n("%Labels_Social_Label_Yandex",n),e.yaservice=!0):o=i18n("%Labels_Social_Label",n),e.social=!0,e.title=o):(e.user&&e.name.length>15&&(e.name=e.name.substr(0,15)+"…"),delete e.social),"important_label"===e.symbolicName&&(e.name=i18n("%Labels_Important"))})),e},sortLabels:function(e){var o=ns.Model.get("settings").getSetting("label_sort");o&&e.sort(n[o])},getSOLabelName:function(o){var t=this.getLabelById(o);return t&&t.name&&0===t.name.indexOf(e)?t.name:null},getImportantLID:function(){var e=this.getLabelBySymbolicName("important_label");return e?e.lid:null},getPriorityLID:function(){var e=this.getLabelBySymbolicName("hamon_label");return e?e.lid:null},getLIDByName:function(e){var o=this.getLabelByName(e);return o?o.lid:null},getLabelById:function(e){return ns.Model.get("label",{lid:e}).getData()},getLabelBySymbolicName:function(e){if(!this._cacheByLid.hasOwnProperty(e)){var o=_.find(this.models,(function(o){return o.get(".symbolicName")===e}));o&&(this._cacheByLid[e]=o.getData())}return this._cacheByLid[e]},getLabelByName:function(e){if(!this._cacheByName.hasOwnProperty(e)&&!this._cacheUserLabelsByName.hasOwnProperty(e)){var o=_.find(this.models,(function(o){return o.get(".name")===e}));o&&(this._cacheByName[e]=o.getData())}return this._cacheByName[e]||this._cacheUserLabelsByName[e]},getUserLabelByName:function(e){if(!this._cacheUserLabelsByName.hasOwnProperty(e)){var o=_.find(this.models,(function(o){return o.get(".user")&&o.get(".name")===e}));o&&(this._cacheUserLabelsByName[e]=o.getData())}return this._cacheUserLabelsByName[e]},adjustCounters:function(e){var o=!1;for(var t in e){var r=this.getLabelById(t);if(r){ns.Model.get("label",{lid:r.lid}).set(".count",r.count+e[t]),o=!0}}return o&&this.touch(),o},getLabelsHash:function(){var e={};return this.models.forEach((function(o){var t=o.getData();t.lid&&(t.user||t.default)&&!t.social&&!("deleted"===t.name&&t.default)&&(e[t.lid]=0)})),e},getUserLabelsCount:function(){var e=0;return this.models.forEach((function(o){o.get(".user")&&e++})),e},isSocial:function(e){var o=this.getLabelById(e);return Boolean(o&&"social"in o)},getWaitingForReplyLabel:function(){return this.getLabelByName(o)},getDelayedMessageLabel:function(){return this.getLabelByName(t)},getPhishingLabel:function(){return this.getLabelByName(this.LABEL_PHISHING_NAME)},getPinnedLabel:function(){return this.getLabelBySymbolicName(this.LABEL_PINNED_SYMBOL_NAME)},canShowEventWidget:function(e){var o=this;return!e.some((function(e){var t=o.getLabelById(e);return t&&"not_show_widget_event"===t.name}))},getMuteThreadLabel:function(){return this.getLabelBySymbolicName(this.LABEL_MUTE_SYMBOL_NAME)},hasUnusedUserLabels:function(){return this.models.some((function(e){return e.get(".user")&&e.get(".unused")}))},getLidsWithUnreadCounter:function(){return[this.getPriorityLID()].filter(Boolean)},adjustUnreadCounters:function(e){Object.keys(e).forEach((function(o){var t=ns.Model.get("label",{lid:o});t&&t.adjustUnreadCount(e[o])}))}}});var e="SystMetkaSO:",o="remindme_threadabout:mark",t="delayed_message",r={yaru:"Я.ру",yandexfotki:"Яндекс.Фотки",yandexvideo:"Яндекс.Видео",yadirect:"Яндекс.Директ",yacards:"Яндекс.Открытки",yamarket:"Яндекс.Маркет",yanarod:"Яндекс.Народ",yaauto:"Яндекс.Авто",yacal:"Яндекс.Календарь",yasupport:"yasupport",yamoney:"Яндекс.Деньги",yandexmusic:"Яндекс.Музыка",yandexwiki:"Яндекс.Вики",yasitesearch:"Яндекс.Поиск",yaxml:"Яндекс.XML",yawebmaster:"Яндекс.Вебмастер",yabetatest:"Яндекс.Бета",yadisk:"Яндекс.Диск",videoletter:"videoletter",moikrug:"Мой Круг",jira:"jira",yandexcom:"Yandex",yandexru:"Яндекс",yandexcomtr:"Yandex",atushka:"atushka",odnoklassniki:"Odnoklassniki.ru",vtnrf0okru:"Odnoklassniki.ru",liveinternet:"Liveinternet.ru",livejournal:"Livejournal.com",vkontakte:"VK.com",vtnrf0vkcom:"VK.com",facebook:"Facebook.com",friendfeed:"Friendfeed.com",habrahabr:"Habrahabr.ru",mirtesen:"Mirtesen.ru",twitter:"Twitter.com",headhunter:"HeadHunter.ru",ozonru:"Ozon.ru",fotostrana:"Fotostrana.ru",subscribe:"Subscribe.ru",mnogoru:"Mnogo.ru",executive:"E-xecutive.ru",myspace:"Myspase.com",youtube:"Youtube.com",professionali:"Professionali.ru",rutube:"Rutube.ru",pingadmin:"Ping-admin.ru",markafoni:"Markafoni.com",yonja:"Yonja.com",formspring:"Formspring.me",oley:"Oley.com",stumbleupon:"Stumbleupon.com",vedomostiru:"Ведомости","yves-rocherru":"yves-rocher.ru",workua:"Work.ua",wordpresscom:"Wordpress",womanjournalru:"wmj.ru",vshtate:"vshtate.ru",vkrugudruzei:"vkrugudruzei",victoriassecretcom:"Victoria's Secret",topshopru:"TOPSHOP",superjob:"SuperJob.ru",smartresponderru:"smartresponder.ru",skyperu:"skype.com",ottoru:"otto.ru",molotokru:"molotok.ru",mcafeecom:"McAfee.com",linkedin:"Linkedin",lamodaru:"lamoda.ru",geometriaru:"Geometria.ru",futuretodayru:"FutureToday.ru",freelance:"Free-lance.ru",evernoteru:"Evernote.com",dissercatcom:"disserCat.com",bookingcom:"Booking.com",b2bcenterru:"B2B-Center.ru",applecom:"Apple.com","24open":"24open",datingsite:"dating",vtnrf0datingsite:"dating",grouponsite:"groupon","4square":"foursquare.com",allegropl:"allegro.pl",darudarorg:"darudar.org",ebaycom:"ebay.com",forum2x2ru:"forum2x2.ru",gideparkru:"gidepark.ru",joobleru:"jooble.ru",justclickru:"JustClick.ru",kolizeoru:"kolizeo.ru",newsprofipostorg:"profi-post.org",newsquickofficecom:"Quickoffice.com",servicegirlsgogamesru:"GirlsgoGames.ru",tradesu:"trade.su",biznesbombaru:"biznesbomba.ru",gate32ru:"gate-32.ru",specservercom:"specserver.com",butikru:"butik.ru",pcdaysru:"pcdays.ru","7yaru":"7ya.ru",info74ru:"info74.ru",floridecorru:"floridecor.ru",allsoftru:"allsoft.ru",forumhouseru:"forumhouse.ru",shopdeluxeru:"shopdeluxe.ru",loccitaneru:"loccitane.ru",emeacom:"ea.com",yarabota:"Яндекс.Работа",yarealty:"Яндекс.Недвижимость",vtnrf024open:"24open.ru",vtnrf04square:"Foursquare",vtnrf07yaru:"7я.ру",vtnrf0afyru:"AFY.ru",vtnrf0allegropl:"Аллегро",vtnrf0allsoftru:"Allsoft",vtnrf0applecom:"Apple",vtnrf0aukroua:"Aukro.ua",vtnrf0avitoru:"AVITO.ru",vtnrf0b2bcenterru:"В2В-Center",vtnrf0beonru:"BeOn",vtnrf0bigbuzzyru:"groupon",vtnrf0biznesbombaru:"Biznesbomba",vtnrf0bookingcom:"Booking.com",vtnrf0burningmancom:"BurningMan.com",vtnrf0busuucom:"busuu.com",vtnrf0butikru:"Бутик.ру",vtnrf0chocolifeme:"Chocolife.me",vtnrf0crewardscom:"crewards.com",vtnrf0darudarorg:"Дару-дар",vtnrf0dealextremecom:"DealExtreme",vtnrf0diaryru:"Diary.ru",vtnrf0dissercatcom:"DisserCat.com",vtnrf0drimmicom:"Drimmicom",vtnrf0ebaycom:"Ebay",vtnrf0emeacom:"EA.com",vtnrf0emirates:"Emirates",vtnrf0evernoteru:"Evernote",vtnrf0executive:"Executive",vtnrf0facebook:"Facebook",vtnrf0floridecorru:"Флор&Декор",vtnrf0formspring:"Formspring",vtnrf0forum2x2ru:"2x2",vtnrf0forumhouseru:"Хост.ру",vtnrf0freelance:"Freelance",vtnrf0friendfeed:"Friendfeed",vtnrf0futuretodayru:"Futuretoday",vtnrf0gate32ru:"Gate32",vtnrf0geometriaru:"Geometria",vtnrf0getresponsecom:"Getresponse.com",vtnrf0gideparkru:"Гайдпарк",vtnrf0githubcom:"Github.com",vtnrf0googlegroupscom:"Google groups",vtnrf0googlecom:"Google",vtnrf0grouponsite:"groupon",vtnrf0gurboyru:"groupon",vtnrf0habrahabr:"Хабрахабр",vtnrf0headhunter:"HH.ru",vtnrf0imnicamailcom:"Imnica mail",vtnrf0info74ru:"Инфо74",vtnrf0infobonprixde:"Bonprix",vtnrf0internetprosru:"Интернет опрос",vtnrf0iskusnitsaru:"Искусница",vtnrf0jobsmarketru:"Jobsmarket.ru",vtnrf0joobleru:"Joobler.u",vtnrf0justclickru:"Just Click",vtnrf0kolizeoru:"KOLIZEO.ru",vtnrf0lamodaru:"Lamoda.ru",vtnrf0linkedin:"Linkedin",vtnrf0liveinternet:"LiveInternet",vtnrf0livejournal:"Livejournal",vtnrf0loccitaneru:"L'occitane",vtnrf0mailluxaleru:"Luxale",vtnrf0markafoni:"Markafoni",vtnrf0mcafeecom:"McAfee",vtnrf0mirtesen:"Мир Тесен",vtnrf0mnogoru:"MNOGO.ru",vtnrf0moikrug:"Мой Круг",vtnrf0molotokru:"Молоток.ру",vtnrf0myfantru:"groupon",vtnrf0myspace:"MY SPACE ",vtnrf0notifyastrostarru:"Астростар.ру",vtnrf0oley:"Oley",vtnrf0ottoru:"Oтто.ру",vtnrf0ozonru:"Озон.ру",vtnrf0pathcom:"Path.com",vtnrf0paypalcom:"PayPal.com",vtnrf0pcdaysru:"PC Days",vtnrf0pingadmin:"Ping-Admin.Ru",vtnrf0professionali:"Профессионалы",vtnrf0quelleinforu:"Quelle",vtnrf0quickofficecom:"Quickoffice",vtnrf0radiomarketru:"Радио Маркет",vtnrf0rdwru:"Работа для Вас",vtnrf0regru:"reg.ru",vtnrf0rutube:"Rutube",vtnrf0servicegirlsgogamesru:"GirlsgoGames",vtnrf0skyperu:"Skype.ru",vtnrf0smartresponderru:"SmartResponder",vtnrf0specservercom:"specserver.com",vtnrf0sprashivairu:"Спрашивай.ру",vtnrf0stumbleupon:"Stumbleupon",vtnrf0subscribe:"Subscribe",vtnrf0superjob:"Superjob",vtnrf0teszveszhu:"teszves",vtnrf0topshopru:"Топ-Шоп.ру",vtnrf0tradesu:"TRADE.SU",vtnrf0twitter:"twitter",vtnrf0vabankcom:"vabank.com",vtnrf0vedomostiru:"Ведомости",vtnrf0victoriassecretcom:"Victoria's secret",vtnrf0vkrugudruzei:"В кругу друзей ",vtnrf0vshtate:"В Штате",vtnrf0wmjru:"Womanjournal",vtnrf0wordpresscom:"Wordpress",vtnrf0workua:"Work.ua",vtnrf0yangutucom:"Yangutu",vtnrf0yonja:"Yonja",vtnrf0youtube:"Youtube","vtnrf0yves-rocherru":"Yves Rocher",vtnrf07vetrovmskru:"7 Ветров",vtnrf0anketkaru:"Анкетка.ру",vtnrf0askfm:"Ask.fm",vtnrf0aviasalesru:"Aviasales.ru",vtnrf0babyblogru:"БебиБлог",vtnrf0babyru:"бэби.ру",vtnrf0bio4freecom:"Bio4free.com",vtnrf0chingoraclecom:"Chingoracle.com",vtnrf0dotnewsru:"Dotnews.ru",vtnrf0edarlingru:"Edarling.ru",vtnrf0finance1ru:"Finance1.ru",vtnrf0fxcluborg:"Forex club",vtnrf0gamenetru:"GameNet",vtnrf0horoscopofreecom:"Horoscopofree.com",vtnrf0jobru:"Job.ru",vtnrf0kissesru:"Kisses.ru",vtnrf0liststarotaroru:"ТароТаро",vtnrf0liveexpertru:"Liveexpert.ru",vtnrf0livemasterru:"Livemaster.ru",vtnrf0malinaru:"Малина",vtnrf0mamsyru:"Mamsy.ru",vtnrf0meggymallru:"Meggy Mall",vtnrf0mithostru:"Mitinfo.ru",vtnrf0pokerstarscom:"PokerStars.com",vtnrf0prestigeua:"Prestige",vtnrf0probelovnet:"Пробелов.Нет",vtnrf0promenadru:"Promenad",vtnrf0qualitynetua:"Quality.net",vtnrf0rabotaua:"Rabota.ua",vtnrf0rugionru:"RUgion",vtnrf0sapatoru:"Sapato.ru",vtnrf0slandoru:"Slando.ru",vtnrf0softkeyru:"Softkey.ru",vtnrf0stilagoinfo:"Emailvision",vtnrf0taggedmailcom:"Tagged",vtnrf0theboutiqueru:"Boutique.ru",vtnrf0topfacecom:"Topface",vtnrf0torrnadoru:"torrНадо.ru",vtnrf0transportlineru:"TransportLine",vtnrf0trudcom:"Trud.com",vtnrf0westwingru:"Westwing",vtnrf0wildberriesru:"Wildberries",vtnrf0wmmailru:"Wmmail.ru",vtnrf0worldoftanksru:"World of Tanks",vtnrf0yourclotheseu:"Boutique.ru"},n={by_abc:function(e,o){return e instanceof ns.Model&&(e=e.getData()),o instanceof ns.Model&&(o=o.getData()),e.name.toLowerCase().localeCompare(o.name.toLowerCase())||e.user-o.user},by_count:function(e,o){return e instanceof ns.Model&&(e=e.getData()),o instanceof ns.Model&&(o=o.getData()),e.user||o.user?o.count-e.count||n.by_abc(e,o):-1}}})()},4046:function(e,o){ns.Model.define("labels-state",{events:{"ns-model-init":"_onInit"},methods:{_onInit:function(){this.setData({isVisibleUnused:!1})},toggleVisibleUnused:function(){this.set(".isVisibleUnused",!this.isVisibleUnused())},isVisibleUnused:function(){return this.get(".isVisibleUnused")}}},ns.ModelStatic)},4047:function(e,o){ns.Model.define("scroller-left",{events:{"ns-model-init":"clean"},methods:{EVENT_NAME:"daria:vScrollerLeft:scroll",_getScroller:function(){return Daria.is2pane()?$(window):$(".js-scroller-left")},getScrollOffset:function(){return 30}}},"scroller-common")},4048:function(e,o){ns.Model.define("left-column-promos",{},ns.ModelStatic)},4049:function(e,o){ns.Model.define("do-collector-remove",{params:{popid:null,fids:null}})},4050:function(e,o,t){t(4051),t(4052),t(4053),t(4054),t(4055),t(4056),t(4057),t(4058),t(4059),t(4060),t(4061),t(4062),t(4063),t(4064),t(4065),t(4066),t(4067),t(4068),t(4069),t(4070),t(4071),t(4072),t(4073),t(4074),t(4075),t(4076),t(4077),t(4078),t(4079),t(4080),t(4081),t(4082),t(4083),t(4084),t(4085),t(4086),t(4087),t(4091)},4051:function(e,o){ns.View.define("left-col-setup-focus-mixin",{methods:{getFocusableChildren:function(){return[this]},onFocusEvent:function(e){switch(e.type){case"focus":this.focusOn();break;case"blur":this.focusOff();break;case"enter":this.focusAction()}},focusOn:function(){this.$node.find(".js-left-col-setup-focus-target").addClass("is-focused")},focusOff:function(){this.$node.find(".js-left-col-setup-focus-target").removeClass("is-focused")}}})},4052:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=t(69);t.n(r);!(function(){var e=Daria.getCookie("broken_collector");ns.ViewCollection.edefine("collectors",{models:{collectors:{"ns-model-changed":"forceUpdate","ns-model-insert":"onCollectorsListChanged","ns-model-remove":"onCollectorsListChanged","ns-model-destroyed":"onCollectorsListChanged"},"collector-settings":!0,settings:{"ns-model-changed":!1,"ns-model-changed.no_collectors_promo":"invalidate"}},split:{byModel:"collectors",intoViews:function(e){return!!e.get(".email")&&"collectors-item"}},events:{"ns-view-htmlinit":"onHtmlInit","ns-view-show":"onShow","ns-view-hide":"onHide","daria:vCollectors:log@show":"_log","daria:vCollectors:setBrokenCollectorCookie@show":"_setBrokenCollectorCookie","daria:vCollectors:showPopupAboutCreate@show":"_showPopupAboutCreate","daria:vCollectors:update@show":"forceUpdate"},yateModule:"left",methods:{Metrika:"Промо сборщиков",onShow:function(){this._cmBaseBindMenuableElements({$node:this.$node,selector:".js-context-menu-target"})},onHide:function(){this._cmBaseUnbindMenuableElements()},onHtmlInit:function(){var o=this.$node.find(".js-collector-unactive"),t=o.first().next();this.$warnings=o.next(),t.length&&(e?this.$warnings.removeClass("g-hidden").each((function(){Jane.c(["Left column","Broken collector","show stripe on the left"])})):window.setTimeout((function(){ns.action.run("collector.warning",t)}),100))},onCollectorsListChanged:function(){this.invalidate(),this.forceUpdate()},_log:function(o,t){e?Jane.c(["Left column","Broken collector","click on stripe",t]):Jane.c(["Left column","Broken collector",t])},_showPopupAboutCreate:function(e,o){this.update().then((function(){var e=this.$node.find('.js-collectors-item[data-email="'+o.email+'"]');if(e.length){var t=e.offset().top+e.height()/2-$(window).scrollTop();Daria.Dialog.open({title:i18n("%Collectors_Promo_ящик_добавлен_заголовок"),body:i18n("%Collectors_Promo_ящик_добавлен_тело",o.email),onTarget:{x:225,y:t,side:"left",pos:"bottom"},width:455})}}),this)},_setBrokenCollectorCookie:function(){this.$warnings.first().hasClass("g-hidden")&&(this.$warnings.removeClass("g-hidden").each((function(){Jane.c(["Left column","Broken collector","show stripe on the left"])})),Daria.setCookie("broken_collector","1",30))},getFocusableChildren:function(){return Daria.nsTreeWalker.getViewsChildren(this)},canShowCollectorsPromo:function(){var e=ns.Model.get("account-information").getDataKey("reg_date"),o=Daria.now()-e>30*Jane.Date.DAY;if(Daria.hasPromoMailProInLeftColumn())return!1;if(o)return!1;if(Object(r.hasFeature)(r.Features.WEB_DISABLE_COLLECTORS_PROMO))return!1;var t=this.getModel("settings"),n=this.getModel("collectors").getData(),s=Array.isArray(n)&&n.length;return!Daria.IS_CORP&&!s&&"on"!==t.getSetting("no_collectors_promo")},isIE:function(){return Boolean(Modernizr.ie11)}}},"context-menu-mixin-collectors",ns.ViewCollection)})()},4053:function(e,o){ns.View.define("collectors-item",{models:{collector:"keepValid","collector-settings":"keepValid"},params:{popid:null},yateModule:"left",methods:{onFocusEvent:function(e){switch(e.type){case"focus":this.focusOn();break;case"blur":this.focusOff();break;case"enter":this.open()}},open:function(){var e=this.getModel("collector").get(".info");ns.page.go(ns.router.generateUrl("messages",{request:e,scope:"rpopinfo",search:"search"}))},focusOn:function(){this.$node.find(".js-collectors-item").addClass("mail-CollectorsList-Item_focus")},focusOff:function(){this.$node.find(".js-collectors-item").removeClass("mail-CollectorsList-Item_focus")}}})},4054:function(e,o){ns.View.edefine("collectors-setup",{models:{collectors:"invalidate"},events:{"ns-view-show":"onInit"},yateModule:"left",methods:{onInit:function(){this.getModel("collectors").getCount()>0&&Jane.c("Left column","Collectors promo","Add mailbox","Show")},focusAction:function(){ns.page.go("#setup/collectors")}}},"left-col-setup-focus-mixin",ns.View)},4055:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=t(1043);ns.View.define("folder",{events:{"ns-view-init":"onInit","click@show .js-folder-mark-all-read":"onClickMarkAllRead","click@show .js-switch-open":"onClickSwitchFolded","click@show .js-folder-info-link":"onClickInfoLink"},models:{folder:{"ns-model-changed":"onFolderModelChanged","ns-model-changed.folded":"onFolderModelChanged"},settings:{"ns-model-changed":!1,"ns-model-changed.hide_empty_folders":"forceUpdate"}},yateModule:"left",methods:{onInit:function(){this._folderId=this.params.fid},onFolderModelChanged:function(e,o){if("ns-model-changed.folded"===e)return void this.$node.toggleClass("is-folded",this.getModel("folder").isFolded());".folded"!==o&&this.forceUpdate()},onClickSwitchFolded:function(){return this.switchFolded(),!1},onClickMarkAllRead:function(e){e.preventDefault(),e.stopPropagation(),nb.trigger("popup-close"),Daria.Dialog.close(),Object(r.a)(this._folderId,"прыщ"),ns.Model.get("settings").isSet("no_popup_mark_read")?Daria.Folder.markRead(this._folderId):this._showMarkAllReadPopup({where:this.$node},{fid:this._folderId})},onClickInfoLink:function(e){ns.events.trigger("daria:vMessages:recalculate"),Object(r.a)(this._folderId,"каунтер непрочитанные"),e.stopPropagation()},_showMarkAllReadPopup:function(e,o){ns.View.create("mark-all-as-read-dialog-popup").open(e,o)},switchFolded:function(){this.getModel("folder").switchFolded()},open:function(){ns.page.go(ns.router.generateUrl("messages",{current_folder:this.params.fid}))},onFocusEvent:function(e){switch(e.type){case"focus":this.focusOn();break;case"blur":this.focusOff();break;case"space":this.switchFolded();break;case"enter":this.open()}},focusOn:function(){this.$node.addClass("mail-FolderList-Item_focus")},focusOff:function(){this.$node.removeClass("mail-FolderList-Item_focus")},getParentReferenceParams:function(){var e=ns.Model.get("folder",{fid:this._folderId});if(e){var o=e.getParent();return o&&o.isFolded()?{params:{fid:o.params.fid}}:void 0}}}})},4056:function(e,o){ns.View.edefine("user-folder",{models:{folder:{"ns-model-changed":"onFolderModelChanged","ns-model-changed.folded":"onFolderModelChanged"},settings:{"ns-model-changed":!1,"ns-model-changed.hide_empty_folders":"forceUpdate"}},yateModule:"left"},"folder",ns.View)},4057:function(e,o){ns.View.edefine("system-folder",{models:{folder:{"ns-model-changed":"onFolderModelChanged","ns-model-changed.folded":"onFolderModelChanged"},settings:{"ns-model-changed":!1,"ns-model-changed.hide_empty_folders":"forceUpdate"}},yateModule:"left"},"folder",ns.View)},4058:function(e,o){ns.View.define("mark-all-as-read-dialog-popup",{yateModule:"left",ctor:function(){this._defaultOptions={withoutTail:!0,autofocus:!0,autoclose:!0,how:{my:"left bottom",at:"right-105px top"}}},methods:{open:function(e,o){this.update({},{execFlag:ns.U.EXEC.PARALLEL}).then((function(){this._popup=nb.block(this.node),e=e||{},this._popup.open(Object.assign({},this._defaultOptions,e)),this._popup.on("click .js-apply-mark-read",this.onMarkAllAsReadPopupApply.bind(this,o)),this._popup.on("click .js-cancel-mark-read",this.onMarkAllAsReadPopupCancel.bind(this)),this._popup.$node.find("input[name=js-always-mark-all-read]").prop("checked",!1),this._popup.on("nb-closed",this.destroySelf.bind(this))}),this)},onMarkAllAsReadPopupApply:function(e){e=e||{},this._popup.$node.find("input[name=js-always-mark-all-read]").prop("checked")&&ns.Model.get("settings").setSettingOn("no_popup_mark_read"),e.tabId&&Daria.MOPS.markReadTab(e.tabId),e.fid&&Daria.Folder.markRead(e.fid),this.close()},onMarkAllAsReadPopupCancel:function(){this.close()},close:function(){this._popup&&(this._popup.close(),this._popup.off("click .js-apply-mark-read"),this._popup.off("click .js-cancel-mark-read"),this._popup.off("click .js-always-mark-read"))},destroySelf:function(){var e=this;_.defer((function(){e._popup&&(e._popup.destroy(),e._popup=null),e.destroy()}))}}})},4059:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=t(1043),n=t(135);t.n(n);!(function(){ns.ViewCollection.edefine("folders",{models:{folders:{"ns-model-changed":"forceUpdate"},settings:{"ns-model-changed":"keepValid","ns-model-changed.folders_open":"forceUpdate","ns-model-changed.hide_empty_folders":"forceUpdate"}},split:{byModel:"folders",intoLayouts:function(e){var o=this.getModel("settings"),t=e.get(".symbol");if(n.HiddenWhenEmptyFolders.includes(t)&&0===e.get(".count"))return!1;if(!e.isOpen())return!1;if(o.isSet("hide_empty_folders")){return!(!n.SystemFolders.includes(t)&&!e.hasUnreadsDeep())&&"common-folder-layout"}return"common-folder-layout"}},events:{"ns-view-htmldestroy":"_onNsViewHtmldestroy","ns-view-hide":"_onNsViewHide","ns-view-show":"_onNsViewShow","ns-view-touch":"_onNsViewTouch","daria:folders.move:done@show":"_onUpdate","daria:vFolders:update@show":"_onUpdate","daria:folder-remove-done@show":"_onUpdate","dragndrop.dragenter@show":"_onDragEnter","dragndrop.drop@show":"_onDrop","click@show .js-folders-item":"_onClickFoldersItem","ns-page-after-load@show":"_onPageAfterLoad"},yateModule:"left",methods:{CLASS_CURRENT:"mail-NestedList-Item_current",CLASS_UPDATED:"mail-NestedList-Item_updated",CLASS_CLOSED:"is-folded",CLASS_JS_NESTING:"js-folders-nesting",CLASS_JS_NESTING_INBOX:"js-folders-nesting-inbox",CLASS_JS_ITEM:"js-folders-item",CLASSES_FOLDERS_GROUP:"mail-FolderList mail-NestedList js-folders",CLASS_FAKE_FOLDER_GROUP:"mail-FolderList_fake",_onNsViewShow:function(){this._cmBaseBindMenuableElements({$node:this.$node,selector:"."+this.CLASS_JS_ITEM})},_onNsViewHide:function(){this._cmBaseUnbindMenuableElements()},_onNsViewHtmldestroy:function(){this.focus&&(this.focus.destroy(),this.focus=null)},_onNsViewTouch:function(){var e=ns.page.current.params,o=this._getFolderIdByParams(e);if(this.selected&&this.selected!==o&&this._getItemNodeByFid(this.selected).removeClass(this.CLASS_CURRENT),o){var t=this.getModel("folders");this._getItemNodeByFid(o).addClass(this.CLASS_CURRENT).removeClass(this.CLASS_UPDATED);var r=t.getFolderById(o);r&&ns.Model.get("reset-unvisited",{fid:r.fid}).resetUnvisited().then((function(e){e&&"recent"in r&&delete r.recent})),this.selected=o,ns.events.trigger("daria:vFolder:changed")}},_getItemNode:function(e){return $(e).closest("."+this.CLASS_JS_ITEM)},_getItemNodeByFid:function(e){return this.$node.find(".fid-"+e)},_onClickFoldersItem:function(e){var o=$(e.currentTarget).hasClass(this.CLASS_CURRENT),t=String($(e.currentTarget).data("fid"));return o&&Object(r.b)("current user folder","click"),Object(r.a)(t,"click"),!!Daria.is3pane()||(!Daria.messages.params4SimplePath(ns.page.current.params)||(o&&ns.page.go(Daria.Page.generateUrl.closeMessage()),o||ns.events.trigger("daria:vFolders:folder-transition"),!0))},_onDragEnter:function(e,o){var t=this._getItemNode(o.currentTarget);this._timer=setTimeout((function(){t.removeClass(this.CLASS_CLOSED),ns.Model.get("folder",{fid:o.fid}).switchFolded(!1)}),300)},_onDrop:function(){this._timer&&clearTimeout(this._timer)},_onUpdate:function(){this.forceUpdate()},_getFolderIdByParams:function(e){var o,t=this.getModel("folders");if(!e.search){if("message"===ns.page.current.page&&e.ids)o=ns.Model.get("message",{ids:e.ids}).getFolderId();else if(Daria.isComposePage()&&e.ids){var r=ns.Model.get("message",{ids:e.ids}).getFolderId(),s=Daria.array2obj(n.DraftLikeFolders.map((function(e){return t.getFidBySymbol(e)})));r in s&&(o=r)}else o=e.current_folder;if(Daria.is3pane()&&!o){var i=e.ids||e.thread_id;i&&(o=ns.Model.get("message",{ids:i}).getFolderId())}return o}},getFocusableChildren:function(){return Daria.nsTreeWalker.getViewsChildren(this)},_logTransitionToFolder:function(e){Daria.monitoring.journal("open",{target:"folder",fid:e.get(".fid"),fidName:e.get(".name"),isUserFolder:e.get(".user")})},_onPageAfterLoad:function(){var e=ns.page.current.params,o=e.current_folder,t=e.tabId,r=ns.page.currentUrl===Daria.Page.referrerUrl,n=Daria.areFoldersTabsEnabled()&&t;if(!r&&o&&!n){var s=ns.Model.get("folder",{fid:o});s.isValid()&&this._logTransitionToFolder(s)}}}},"context-menu-mixin-folders",ns.ViewCollection)})()},4060:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=t(135);t.n(r);!(function(){ns.ViewCollection.define("user-folders",{models:{folders:{"ns-model-changed":"forceUpdate"},settings:{"ns-model-changed":"keepValid","ns-model-changed.folders_open":"forceUpdate","ns-model-changed.hide_empty_folders":"forceUpdate"}},events:{"user-folders-folded":"forceUpdate","ns-view-htmldestroy":"_onNsViewHtmldestroy","ns-view-hide":"_onNsViewHide","ns-view-show":"_onNsViewShow","ns-view-touch":"_onNsViewTouch","click@show .js-folders-item":"_onClickFoldersItem","daria:folders.move:done@show":"_onUpdate","daria:vFolders:update@show":"_onUpdate","daria:folder-remove-done@show":"_onUpdate","dragndrop.dragenter@show":"_onDragEnter","dragndrop.drop@show":"_onDrop","ns-page-after-load@show":"_onPageAfterLoad"},split:{byModel:"folders",intoLayouts:function(e){return!(!e.isOpen()||!this.shouldShowAsUserFolder(e))&&(!(this.getModel("settings").isSet("hide_empty_folders")&&!e.hasUnreadsDeep())&&"user-folder-layout")}},methods:{shouldShowAsUserFolder:function(e){if(!e.isValid())return!1;var o=this.getModel("folders"),t=e.get(".fid");return e.get(".user")&&o.hasChildByFid(o.getFidBySymbol(r.WellKnownFolderSymbol.INBOX),t)&&!o.isFolder(t,r.WellKnownFolderSymbol.ARCHIVE)},_onDragEnter:function(e,o){if(o.fid){var t=ns.Model.get("folder",{fid:o.fid});this.shouldShowAsUserFolder(t)&&this.super_._onDragEnter(e,o)}},_logTransitionToFolder:function(e){this.shouldShowAsUserFolder(e)&&this.super_._logTransitionToFolder(e)}},yateModule:"left"},"folders")})()},4061:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=t(135);t.n(r);ns.View.define("user-folders-switcher",{models:{folders:{"ns-model-changed":"keepValid","ns-model-remove":"forceUpdate","ns-model-insert":"forceUpdate"}},events:{"ns-view-show":"onShow","ns-view-hide":"onHide",click:"onUserFoldersSwitch","click .js-add-folder":"addFolder"},ctor:function(){this._bindedForceUpdate=this.forceUpdate.bind(this),this._isInFocus=!1},methods:{_FOCUS_CLASS:"is-focused",shouldShowSwitcher:function(){return(this.getModel("folders").models||[]).some(ns.View.infoLite("user-folders").methods.shouldShowAsUserFolder.bind(this))},onShow:function(){this._getInboxFolder().on("ns-model-changed.folded",this._bindedForceUpdate)},onHide:function(){this._getInboxFolder().off("ns-model-changed.folded",this._bindedForceUpdate)},onUserFoldersSwitch:function(e){return e.preventDefault(),this.toggleUserFoldersFolding(),ns.events.trigger("user-folders-folded",{isFolded:this.isFoldersFolded()}),!1},toggleUserFoldersFolding:function(){this._getInboxFolder().switchFolded()},isFoldersFolded:function(){return this._getInboxFolder().isFolded()},getUserFoldersCount:function(){var e=this.getModel("folders");return e.getAllSubfoldersFid(e.getFidBySymbol(r.WellKnownFolderSymbol.INBOX)).filter((function(o){return!e.isFolder(o,r.WellKnownFolderSymbol.ARCHIVE)})).length},getFocusableChildren:function(){return Daria.areCompactFolderTabsEnabled()?this.shouldShowSwitcher()?[this]:[]:[this]},onFocusEvent:function(e){switch(e.type){case"focus":this.focusOn();break;case"blur":this.focusOff();break;case"space":this.toggleUserFoldersFolding()}},focusOn:function(){this.$node.addClass(this.getFocusClass()),this._isInFocus=!0},focusOff:function(){this.$node.removeClass(this.getFocusClass()),this._isInFocus=!1},isInFocus:function(){return this._isInFocus},getFocusClass:function(){return this._FOCUS_CLASS},addFolder:function(e){ns.action.run("folders.add",{"only-create":1}),e.stopPropagation()},_getInboxFolder:function(){return ns.Model.get("folder",{fid:this.getModel("folders").getFidBySymbol(r.WellKnownFolderSymbol.INBOX)})}},yateModule:"left"})},4062:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=t(135);t.n(r);!(function(){ns.ViewCollection.define("system-folders",{models:{folders:{"ns-model-changed":"forceUpdate"},settings:{"ns-model-changed":"keepValid","ns-model-changed.folders_open":"forceUpdate","ns-model-changed.hide_empty_folders":"forceUpdate"}},events:{"ns-view-htmldestroy":"_onNsViewHtmldestroy","ns-view-hide":"_onNsViewHide","ns-view-show":"_onNsViewShow","ns-view-touch":"_onNsViewTouch","click@show .js-folders-item":"_onClickFoldersItem","daria:folders.move:done@show":"_onUpdate","daria:vFolders:update@show":"_onUpdate","daria:folder-remove-done@show":"_onUpdate","dragndrop.dragenter@show":"_onDragEnter","dragndrop.drop@show":"_onDrop","ns-page-after-load@show":"_onPageAfterLoad"},split:{byModel:"folders",intoLayouts:function(e){var o=this.getModel("folders"),t=e.get(".fid"),n=e.get(".symbol");if(!e.isOpen()||!this.shouldShowAsSystemFolder(e))return!1;if(r.HiddenWhenEmptyFolders.includes(n)&&0===e.get(".count"))return!1;var s=this.getModel("settings"),i=o.isSystemFolder(t);return!(s.isSet("hide_empty_folders")&&!e.hasUnreadsDeep()&&!i)&&"system-folder-layout"}},methods:{shouldShowAsSystemFolder:function(e){if(!e.isValid())return!1;var o=this.getModel("folders"),t=e.get(".fid"),n=[r.WellKnownFolderSymbol.INBOX],s=o.isFolder(t,r.WellKnownFolderSymbol.ARCHIVE)||o.isSystemFolder(t)&&!o.isFolder(t,n),i=!s&&o.isSystemFolderChild(t,(function(e){return-1===n.indexOf(e)}));return s||i},_onDragEnter:function(e,o){if(o.fid){var t=ns.Model.get("folder",{fid:o.fid});this.shouldShowAsSystemFolder(t)&&this.super_._onDragEnter(e,o)}},_logTransitionToFolder:function(e){this.shouldShowAsSystemFolder(e)&&this.super_._logTransitionToFolder(e)}},yateModule:"left"},"folders")})()},4063:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=t(135);t.n(r);ns.View.edefine("folders-setup",{yateModule:"left",models:{folders:{"ns-model-changed":"keepValid","ns-model-remove":"forceUpdate","ns-model-insert":"forceUpdate"},settings:{"ns-model-changed":"keepValid","ns-model-changed.show_folders_tabs":"invalidate"}},events:{"ns-view-show":"onShow","ns-view-hide":"onHide","click .js-folders-setup-add":"addFolder"},ctor:function(){this._bindedForceUpdate=this.forceUpdate.bind(this)},methods:{onShow:function(){this._getInboxFolder().on("ns-model-changed.folded",this._bindedForceUpdate)},onHide:function(){this._getInboxFolder().off("ns-model-changed.folded",this._bindedForceUpdate)},focusAction:function(){this.addFolder()},addFolder:function(){ns.action.run("folders.add",{"only-create":1})},_getInboxFolder:function(){var e=ns.Model.get("folders");return ns.Model.get("folder",{fid:e.getFidBySymbol(r.WellKnownFolderSymbol.INBOX)})},isHidden:function(){return Boolean(Daria.areCompactFolderTabsEnabled()&&this._hasVisibleUserFolder())},isInboxFolded:function(){return this._getInboxFolder().isFolded()},_hasVisibleUserFolder:function(){return(this.getModel("folders").models||[]).some(ns.View.infoLite("user-folders").methods.shouldShowAsUserFolder.bind(this))},getFocusableChildren:function(){return this.isHidden()?[]:[this]}}},"left-col-setup-focus-mixin",ns.View)},4064:function(e,o){ns.View.define("messages-filters",{models:{"messages-filters":!0},yateModule:"left"})},4065:function(e,o){ns.View.define("messages-filters-metrics-mixin",{events:{click:"sendMetricOnClick","ns-view-show":"sendMetricOnShow"},methods:{sendMetricOnShow:Daria.memoizeById({},(function(){return this.__uniqueId}),(function(){this.sendMetric("Show")})),sendMetricOnClick:function(){this.sendMetric("Click")},sendMetric:function(){for(var e,o=Daria.is2pane()?"2pane":"3pane",t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];(e=Jane).c.apply(e,["Left column",o,"System labels",this.METRIC_NAME].concat(r))}}})},4066:function(e,o){ns.View.define("messages-filters-focus-mixin",{methods:{getFocusableChildren:function(){return[this]},onFocusEvent:function(e){switch(e.type){case"focus":this.focusOn();break;case"blur":this.focusOff();break;case"enter":this.open()}},focusOn:function(){this.$node.find(".js-labels-item").addClass("mail-LabelList-Item_focus")},focusOff:function(){this.$node.find(".js-labels-item").removeClass("mail-LabelList-Item_focus")}}})},4067:function(e,o){ns.View.edefine("messages-filters-wait",{models:{"messages-filters":!0,labels:{"ns-model-changed":"forceUpdate"},folders:{"ns-model-changed":"forceUpdate"}},yateModule:"left",methods:{METRIC_NAME:"Waiting for answer",open:function(){var e=ns.Model.get("labels"),o=e.getLabelByName("remindme_threadabout:mark");ns.page.go(ns.router.generateUrl("messages",{current_label:o.lid}))}}},"messages-filters-focus-mixin","messages-filters-metrics-mixin",ns.View)},4068:function(e,o){ns.View.edefine("messages-filters-important",{models:{"messages-filters":!0,labels:{"ns-model-changed":"forceUpdate"},folders:{"ns-model-changed":"forceUpdate"}},yateModule:"left",methods:{METRIC_NAME:"Important",open:function(){ns.page.go(ns.router.generateUrl("messages",{important:"important"}))}}},"messages-filters-focus-mixin","messages-filters-metrics-mixin",ns.View)},4069:function(e,o){ns.View.edefine("messages-filters-unread",{models:{"messages-filters":!0,labels:{"ns-model-changed":"forceUpdate"},folders:{"ns-model-changed":"forceUpdate"}},yateModule:"left",methods:{METRIC_NAME:"Unread",open:function(){ns.page.go(ns.router.generateUrl("messages",{unread:"unread"}))}}},"messages-filters-focus-mixin","messages-filters-metrics-mixin",ns.View)},4070:function(e,o){ns.View.edefine("messages-filters-attachments",{models:{"messages-filters":!0,labels:{"ns-model-changed":"forceUpdate"},folders:{"ns-model-changed":"forceUpdate"}},yateModule:"left",methods:{METRIC_NAME:"With attachments",open:function(){ns.page.go(ns.router.generateUrl("messages",{attachments:"attachments"}))}}},"messages-filters-focus-mixin","messages-filters-metrics-mixin",ns.View)},4071:function(e,o){ns.View.edefine("log-show-of-empty-labels-mixin",{methods:{_timerThatLogsShowOfEmptyLabels:null,logIfEmptyWithDelay:function(){0!==this.$node.find(".js-error-mode").length?this.startLogShowOfEmptyLabels():this.cancelLogShowOfEmptyLabels()},startLogShowOfEmptyLabels:function(){this._timerThatLogsShowOfEmptyLabels||(this._timerThatLogsShowOfEmptyLabels=setTimeout(this.logShowOfEmptyLabels.bind(this),1e4))},cancelLogShowOfEmptyLabels:function(){this._timerThatLogsShowOfEmptyLabels&&(clearTimeout(this._timerThatLogsShowOfEmptyLabels),this._timerThatLogsShowOfEmptyLabels=null)},logShowOfEmptyLabels:function(){this._timerThatLogsShowOfEmptyLabels=null,Jane.ErrorLog.send({errorType:"labels_show_empty"})}}})},4072:function(e,o){!(function(){ns.ViewCollection.edefine("labels",{models:{labels:{"ns-model-changed":"onModelLabelsChanged"},"labels-state":{"ns-model-changed":"keepValid","ns-model-changed.isVisibleUnused":"forceUpdate"}},split:{byModel:"labels",intoViews:function(e){if(e.get(".user")){var o=this.getModel("labels-state").isVisibleUnused();Daria.resize.isWithCompactLeftColumn&&(o=!1);var t=e.get(".lid")===ns.page.current.params.current_label;if(o||t||!o&&!e.get(".unused"))return"label"}return!1}},events:{"ns-view-show":"onShow","ns-view-hide":"onHide","daria:vLabels:update@show":"forceUpdate","daria:vLabels:invalidate@show":"invalidate","daria:label-remove-done@show":"forceUpdate","ns-page-after-load@show":"_onPageAfterLoad","click .js-add-label":"addLabel"},yateModule:"left",methods:{onShow:function(){this._cmBaseBindMenuableElements({$node:this.$node,selector:".js-labels-item"}),this.logIfEmptyWithDelay()},onHide:function(){this._cmBaseUnbindMenuableElements(),this.cancelLogShowOfEmptyLabels()},onModelLabelsChanged:function(){var e=this.getModel("labels");e.sortLabels(e.models),this.forceUpdate()},getFocusableChildren:function(){return Daria.nsTreeWalker.getViewsChildren(this)},_onPageAfterLoad:function(){var e=ns.page.current.params.current_label,o=this.getModel("labels").getLabelById(e);if(!o||Daria.isPriorityTab())return null;Daria.monitoring.journal("open",{target:"label",lid:o.lid,lidName:o.name,isUserLabel:o.user})},hasVisibleLabels:function(){return(this.getModel("labels").models||[]).some(ns.View.infoLite("labels").split.intoViews.bind(this))},addLabel:function(){ns.action.run("labels.add",{"only-create":1})}}},"context-menu-mixin-labels","log-show-of-empty-labels-mixin",ns.ViewCollection)})()},4073:function(e,o){ns.View.define("label",{events:{"ns-page-after-load":"onAfterPageLoad"},models:{label:"forceUpdate"},params:{lid:null},yateModule:"left",methods:{onAfterPageLoad:function(){var e=ns.page.current.params,o=this.params.lid===e.current_label;this.$node.find(".js-labels-item ").toggleClass("is-checked",o)},onFocusEvent:function(e){switch(e.type){case"focus":this.focusOn();break;case"blur":this.focusOff();break;case"enter":this.open()}},open:function(){ns.page.go(ns.router.generateUrl("messages",{current_label:this.params.lid}))},focusOn:function(){this.$node.find(".js-labels-item").addClass("mail-LabelList-Item_focus")},focusOff:function(){this.$node.find(".js-labels-item").removeClass("mail-LabelList-Item_focus")}}})},4074:function(e,o){ns.View.edefine("labels-setup",{models:{labels:{"ns-model-changed":!1,"ns-model-remove":"forceUpdate"},"labels-state":!0},events:{"click .js-labels-setup-add":"addLabel","click@show .js-hidden-labels-toggler":"onClickHiddenLabelsToggler"},yateModule:"left",methods:{onClickHiddenLabelsToggler:function(){Daria.areCompactFolderTabsEnabled()&&ns.events.trigger("daria:vLabels:invalidate"),this.getModel("labels-state").toggleVisibleUnused()},focusAction:function(){this.addLabel()},addLabel:function(){ns.action.run("labels.add",{"only-create":1})}}},"left-col-setup-focus-mixin",ns.View)},4075:function(e,o){ns.View.define("main-action-buttons-content",{events:{"click .js-main-action-compose":"onComposeClick","click .js-main-action-refresh":"onClickRefreshButton"},yateModule:"left",methods:{onComposeClick:function(e){this._composeMetrika(),ns.action.run("compose.click",null,this.node,e)},onClickRefreshButton:function(){this._refreshMetrika()},_composeMetrika:function(){Jane.ToolbarMetric.messagesListToolbar(null,"compose")},_refreshMetrika:function(){Jane.ToolbarMetric.messagesListToolbar(null,"check mail")}}})},4076:function(e,o){ns.View.define("main-action-buttons",{events:{"ns-view-htmlinit":"startDetectScrollbar","ns-view-htmldestroy":"cancelDetectScrollbar","ns-view-show":"onChanged","toolbar.fixed":"_adjustElementsForStickyComposeButtons","daria:vApp:changeLeftColumWidth@show":"onChanged","Daria:vToolbar:toggleVisibilityWithUnfoldedSearch":"toggleVisibilityStickyComposeButtons","resize window":"onFolderChanged"},yateModule:"left",ctor:function(){this.onFolderChanged=_.throttle(this.onFolderChanged.bind(this),300),this.observer=new MutationObserver(this.onFolderChanged)},methods:{_getComposeButtonsContainer:function(){return this.$node.find(".js-compose-button-container")},_getResizeLeftColumnToggler:function(){return this._getLayoutAsideBoxNode().find(".js-layout-left-toggler")},_getLayoutAsideBoxNode:function(){return this.$node.closest(".js-layout-left")},_isMainToolbarHidden:function(){return $(".js-toolbar").hasClass("is-hidden")},_addUnfoldedSearchFlag:function(e){ns.Model.get("app-state").updatePageClasses({"with-unfolded-search":e})},toggleFixedLeftColumnToggler:function(){this._isIE()&&Daria.is2pane()&&this._toggleFixedLayoutAsideNodeIE(),this._toggleFixedLeftColumnToggler()},_toggleFixedLeftColumnToggler:function(){this._getResizeLeftColumnToggler().toggleClass("is-fixed",this._isMainToolbarFixed())},_toggleFixedLayoutAsideNodeIE:function(){this._getLayoutAsideBoxNode().parent().toggleClass("is-ie-fixed",this._isMainToolbarFixed())},_isIE:function(){return"MSIE"===Daria.UA.BrowserName||"Edge"===Daria.UA.BrowserName},toggleFixedComposeButtons:function(){Daria.is2pane()&&this.$node.toggleClass("is-fixed",this._isMainToolbarFixed())},toggleVisibilityStickyComposeButtons:function(e,o){(Daria.CompactMode.isCompactHeader()||Daria.is2pane())&&this._addUnfoldedSearchFlag(o||this._isMainToolbarHidden())},isComposeButtonsScrolled:function(){return 0!==this._getScrollerModel().getScroller().scrollTop()},isMessagesListIn3paneScrolled:function(){return 0!==ns.Model.get("scroller-messages").getScroller().scrollTop()},_isMainToolbarFixed:function(){var e=ns.page.current.page;return ns.Model.get("toolbar",{layout:e}).isFixed()},_getScrollerModel:function(){return ns.Model.get("scroller-left")},_adjustElementsForStickyComposeButtons:function(){this.toggleFixedComposeButtons(),this.setOptimalWidthForComposeButtons(),this.toggleFixedLeftColumnToggler(),this.setOptimalIndentForControlResizeLeftColumn(),this.toggleVisibilityStickyComposeButtons()},setOptimalWidthForComposeButtons:function(){if(Daria.is2pane()){var e=this._getLayoutAsideBoxNode(),o=this._getOptimalPadding();this._isMainToolbarFixed()?this._getComposeButtonsContainer().css("width",e.width()-o):this._getComposeButtonsContainer().css("width","auto")}},_getOptimalPadding:function(){var e={standardPaddingRight:24,compactPaddingRight2pane:12};return Daria.resize.isWithCompactLeftColumn?e.compactPaddingRight2pane:e.standardPaddingRight},setOptimalIndentForControlResizeLeftColumn:function(){if(Daria.is2pane()){var e=this._getResizeLeftColumnToggler();if(this._isMainToolbarFixed()){var o=this._getComposeButtonsContainer();if(!o)return;var t=o.innerWidth()-o.width(),r=o.offset().left+o.innerWidth()-t/2;Daria.is2pane()&&Daria.resize.isWithCompactLeftColumn&&this._isIE()&&(r-=10),e.css("left",r)}else e.css("left","")}},startDetectScrollbar:function(){var e={attributes:!0,subtree:!0,childList:!0};this._isNeedToDetectScrollbar()&&this.observer.observe(this._getLayoutAsideBoxNode()[0],e)},cancelDetectScrollbar:function(){this.observer.disconnect()},onFolderChanged:function(){if(this._isNeedToDetectScrollbar()){var e=this._getScrollerNode();return this.$node.toggleClass("with-padding",this._hasScrollbar(e)),!1}},_isNeedToDetectScrollbar:function(){var e=this._getScrollerNode();return Boolean(Daria.is3pane()&&e)},_getScrollerNode:function(){return ns.Model.get("scroller-left").getScroller()[0]},_hasScrollbar:function(e){return e.scrollHeight-e.clientHeight>0},onChanged:function(){this._adjustElementsForStickyComposeButtons(),this.onFolderChanged()}}})},4077:function(e,o){ns.View.edefine("skin-saver",{events:{"ns-view-show":"onShow","ns-view-hide":"onHide","ns-page-before-load@show":"onPageBeforeLoad","click .js-preview-skin":"togglePreviewMode","daria:vSkinSaver:rotateSkin@show":"forceUpdate"},models:{settings:{"ns-model-changed":"onSettingsChanged","ns-model-changed.color_scheme":"forceUpdate"},"skin-saver-state":{"ns-model-changed":!1,"ns-model-changed.previewMode":"forceUpdate"}},yateModule:"left",methods:{onShow:function(){var e=this.getModel("skin-saver-state");this.togglePageScroll(!e.isPreviewMode()),this.nbCheckbox=nb.$block(".js-save-skin",this.$node),this.nbCheckbox&&this.nbCheckbox.on("nb-changed",this.onCheckboxChange.bind(this))},onHide:function(){this.togglePageScroll(!0),this.nbCheckbox&&this.nbCheckbox.off("nb-changed")},togglePageScroll:function(e){["DOMMouseScroll","mousewheel","scroll"].forEach((function(o){window.removeEventListener(o,this.preventScroll),e||window.addEventListener(o,this.preventScroll)}),this)},preventScroll:function(e){e.stopPropagation(),e.preventDefault();var o=ns.Model.get("skin-saver-state"),t=o.get(".scrollTop");$("body").scrollTop(t)},onCheckboxChange:function(){var e=ns.Model.get("themes").getCurrentTheme();this.isSaved()?e.removeSavedSkin():(e.saveCurrentSkin(),Jane.c(["Выпадушка тем","оставить этот фон"]))},isSaved:function(){return ns.Model.get("themes").getCurrentTheme().currentSkinIsSaved()},togglePreviewMode:function(){var e=this.getModel("skin-saver-state"),o=!e.isPreviewMode();this.togglePageScroll(!o),e.set(".scrollTop",$("body").scrollTop()),e.togglePreviewMode(o),o&&Jane.c(["Выпадушка тем","показать фон"])},onSettingsChanged:function(e,o){o=o||"",/-skin$/.test(o)&&this.forceUpdate()},hasPreview:function(){return ns.Model.get("themes").getCurrentTheme().hasPreview()},getSkinText:function(){var e=ns.Model.get("themes").getCurrentTheme();if("love_is"!==e.get(".data.name"))return e.getSkinText()},onPageBeforeLoad:function(e,o){if(!_.isEqual(o[0],o[1])){var t=this.getModel("skin-saver-state");t.isPreviewMode()&&(t.togglePreviewMode(!1),window.history.forward())}}}})},4078:function(e,o){var t={inbox:"Unsorted inbox",attachments:"Attachments",relevant:"Inbox",news:"Maillists",social:"Social networks",priority:"Priority"};ns.View.edefine("tabs-metrics-mixin",{events:{click:"open"},methods:{sendMetric:function(e){var o=t[e];o&&Jane.c("Left column",Daria.is2pane()?"2pane":"3pane","Tabs list",o,"click/open")}}})},4079:function(e,o){ns.View.edefine("base-tab",{events:{"click@show .js-tab-mark-all-read":"onClickMarkAllRead","click@show .js-tab-info-link":"onClickInfoLink","ns-view-touch":"onViewTouch","ns-page-after-load@show":"onPageAfterLoad"},methods:{getFocusableChildren:function(){return[this]},onFocusEvent:function(e){switch(e.type){case"focus":this.focusOn();break;case"blur":this.focusOff();break;case"enter":this.open()}},focusOn:function(){this.$node.find(".mail-Tabs-Item").addClass("mail-FolderList-Item_focus")},focusOff:function(){this.$node.find(".mail-Tabs-Item").removeClass("mail-FolderList-Item_focus")},open:function(){ns.page.go(ns.router.generateUrl("messages",{tabId:this.params.id})),this.sendMetric(this.params.id)},onClickMarkAllRead:function(e){e.preventDefault(),e.stopPropagation(),nb.trigger("popup-close"),Daria.Dialog.close(),ns.Model.get("settings").isSet("no_popup_mark_read")?Daria.MOPS.markReadTab(this.params.id):this._showMarkAllReadPopup({where:this.$node},{tabId:this.params.id})},onClickInfoLink:function(e){ns.events.trigger("daria:vMessages:recalculate"),e.stopPropagation()},_showMarkAllReadPopup:function(e,o){ns.View.create("mark-all-as-read-dialog-popup").open(e,o)},CLASS_CURRENT:"mail-NestedList-Item_current",CLASS_UPDATED:"mail-NestedList-Item_updated",onViewTouch:function(){var e=this._getTabIdByParams(ns.page.current.params),o=this._getItemNode();if(!e||e!==this.params.id)return void o.removeClass(this.CLASS_CURRENT);o.addClass(this.CLASS_CURRENT).removeClass(this.CLASS_UPDATED);var t=this.getModel("tabs"),r=t.getTab(e);r&&ns.Model.get("reset-unvisited",{tabId:e}).resetUnvisited().then((function(e){e&&"recent"in r.getData().counters&&r.clearRecent()}))},onPageAfterLoad:function(){var e=ns.page.current.params.tabId;!(ns.page.currentUrl===Daria.Page.referrerUrl)&&e&&ns.Model.get("tabs").getTab(e)&&Daria.monitoring.journal("open",{target:"tab",tabId:e})},_getItemNode:function(){return this.$node.find(".js-tabs-item")},_getTabIdByParams:function(e){return"message"===ns.page.current.page&&e.ids?ns.Model.get("message",{ids:e.ids}).getTabId():e.tabId}}},"context-menu-mixin-tabs","tabs-metrics-mixin",ns.View)},4080:function(e,o){ns.View.edefine("base-mimic-tab",{events:{"click@show .js-tab-mark-all-read":"onClickMarkAllRead","click@show .js-tab-info-link":"onClickInfoLink","ns-view-show":"onShow","ns-view-hide":"onHide","ns-view-touch":"updateActiveClass","ns-page-after-load@show":"onPageAfterLoad"},methods:{getTabId:function(){throw new Error('"getTabId" is not implemented')},getIsCurrent:function(){throw new Error('"getIsCurrent" is not implemented')},getMarkAllReadPopupParams:function(){throw new Error('"getMarkAllReadPopupParams" is not implemented')},markRead:function(){throw new Error('"markRead" is not implemented')},updateActiveClass:function(){this.$node.find(".js-tabs-item").toggleClass("mail-NestedList-Item_current",this.getIsCurrent())},getFocusableChildren:function(){return[this]},onFocusEvent:function(e){switch(e.type){case"focus":this.focusOn();break;case"blur":this.focusOff();break;case"enter":this.open()}},focusOn:function(){this.$node.find(".mail-Tabs-Item").addClass("mail-FolderList-Item_focus")},focusOff:function(){this.$node.find(".mail-Tabs-Item").removeClass("mail-FolderList-Item_focus")},onClickMarkAllRead:function(e){e.preventDefault(),e.stopPropagation(),nb.trigger("popup-close"),Daria.Dialog.close(),ns.Model.get("settings").isSet("no_popup_mark_read")?this.markRead():this._showMarkAllReadPopup({where:this.$node},this.getMarkAllReadPopupParams())},_showMarkAllReadPopup:function(e,o){ns.View.create("mark-all-as-read-dialog-popup").open(e,o)},onClickInfoLink:function(e){ns.events.trigger("daria:vMessages:recalculate"),e.stopPropagation()},onPageAfterLoad:function(){var e=ns.page.currentUrl===Daria.Page.referrerUrl;if(this.updateActiveClass(),this.getIsCurrent()&&!e){var o=this.getTabId();Daria.monitoring.journal("open",{target:"tab",tabId:o}),this.sendMetric(o)}},__extractId:function(){return this.getTabId()}}},"context-menu-mixin-tabs","tabs-metrics-mixin",ns.View)},4081:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=t(135);t.n(r);ns.View.edefine("inbox-tab",{params:function(){return{fid:ns.Model.get("folders").getFolderBySymbol(r.WellKnownFolderSymbol.INBOX).fid}},models:{folder:"forceUpdate"},yateModule:"left",methods:{getTabId:function(){return"inbox"},getIsCurrent:function(){return"messages"===ns.page.current.page&&ns.page.current.params.current_folder===this.params.fid},markRead:function(){Daria.Folder.markRead(this.params.fid)},getMarkAllReadPopupParams:function(){return{fid:this.params.fid}},open:function(){ns.page.go(ns.router.generateUrl("messages",{current_folder:this.params.fid}))}}},"base-mimic-tab",ns.View)},4082:function(e,o){ns.View.edefine("relevant-tab",{paramsRewrite:function(e){return e.id="relevant",e},models:{tabs:"invalidate",tab:{"ns-model-changed":"forceUpdate"},folders:"keepValid"},yateModule:"left"},"base-tab")},4083:function(e,o){ns.View.edefine("priority-tab",{params:function(){return{lid:ns.Model.get("labels").getPriorityLID()}},models:{label:"forceUpdate"},yateModule:"left",methods:{getTabId:function(){return"priority"},getIsCurrent:Daria.isPriorityTab,open:function(){ns.page.go(ns.router.generateUrl("messages",{current_label:this.params.lid}))}}},"base-mimic-tab",ns.View)},4084:function(e,o){ns.View.edefine("news-tab",{paramsRewrite:function(e){return e.id="news",e},models:{tabs:"invalidate",tab:{"ns-model-changed":"forceUpdate"},folders:"keepValid"},yateModule:"left"},"base-tab")},4085:function(e,o){ns.View.edefine("social-tab",{paramsRewrite:function(e){return e.id="social",e},models:{tabs:"invalidate",tab:{"ns-model-changed":"forceUpdate"},folders:"keepValid"},yateModule:"left"},"base-tab")},4086:function(e,o){ns.View.edefine("attachments-tab",{models:{"messages-filters":!0},yateModule:"left",methods:{getTabId:function(){return"attachments"},getIsCurrent:function(){return"attachments"===this.getModel("messages-filters").get(".filter")},open:function(){ns.page.go(ns.router.generateUrl("messages",{attachments:"attachments"}))}}},"base-mimic-tab",ns.View)},4087:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=t(329),n=t(4088);ns.View.define("mail-pro-left-column-button",{events:{"ns-view-htmlinit":"onHtmlInit","ns-view-htmldestroy":"onHtmlDestroy"},yateModule:"mail",methods:{onHtmlInit:function(){this.unmount=Object(n.a)(this.node)},onHtmlDestroy:function(){this.unmount()},getFocusableChildren:function(){return[this]},onFocusEvent:function(e){switch(e.type){case"focus":this.focusOn();break;case"blur":this.focusOff();break;case"enter":this.open()}},open:function(){window.open(Object(r.getLinkToMailPro)("pro_left_column_button"),"_blank")},focusOn:function(){this.$node.find(".mail-ProLeftColumnButton__pro-button").addClass("is-focused")},focusOff:function(){this.$node.find(".mail-ProLeftColumnButton__pro-button").removeClass("is-focused")}}})},4091:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=t(760),n=(t.n(r),t(4092));t.n(n);ns.View.define("mail-pro-left-column-widget",Object(r.NsReactView)({component:n.ConnectedLeftColumnWidget,yateModule:"mail",models:["left-column-promos","settings"]}))},4092:function(e,o,t){"use strict";var r=this&&this.__extends||(function(){var e=function(o,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(e[t]=o[t])})(o,t)};return function(o,t){function r(){this.constructor=o}e(o,t),o.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}})(),n=this&&this.__decorate||function(e,o,t,r){var n,s=arguments.length,i=s<3?o:null===r?r=Object.getOwnPropertyDescriptor(o,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,o,t,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(i=(s<3?n(i):s>3?n(o,t,i):n(o,t))||i);return s>3&&i&&Object.defineProperty(o,t,i),i},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0}),o.ConnectedLeftColumnWidget=void 0;var i=s(t(321)),a=t(324),l=t(327),d=t(329),c=t(4093),u=t(4095),f=t(4097),m=275,h=165,p=(function(e){function o(){var o=null!==e&&e.apply(this,arguments)||this;return o.state={collapsed:!1,hidden:!0},o.rootRef=i.default.createRef(),o.widgetStateStore=c.LeftColumnProWidgetState.instance(),o.resizeWatcher=new f.ResizeWatcher,o.onClose=function(){return o.widgetStateStore.closeWidget()},o.logClick=function(){return o.widgetStateStore.logClick(o.widgetMetrikaState)},o.onResize=function(e){if(e){var t=e.width<=h;o.state.hidden!==t&&o.setState({hidden:t});var r=e.width<=m;o.state.collapsed!==r&&o.setState({collapsed:r}),o.widgetState!==u.MailProLeftColumnWidget.State.HIDDEN&&o.markWidgetShown()}},o}return r(o,e),o.prototype.componentDidMount=function(){this.observeCurrentRef()},o.prototype.componentDidUpdate=function(){this.unobservePreviousRef(),this.observeCurrentRef()},o.prototype.componentWillUnmount=function(){this.observableRef&&this.resizeWatcher.unwatch(this.observableRef),delete this.observableRef},o.prototype.render=function(){var e=this.widgetStateStore.texts;if(!e)return null;var o=this.widgetStateStore.href||d.getLinkToMailPro("mail_lkbtn");return i.default.createElement(u.MailProLeftColumnWidget,{texts:e,href:o,rootRef:this.rootRef,state:this.widgetState,onClose:this.onClose,onClick:this.logClick})},Object.defineProperty(o.prototype,"widgetState",{get:function(){return this.state.hidden?u.MailProLeftColumnWidget.State.HIDDEN:this.widgetStateStore.collapsed||this.state.collapsed?u.MailProLeftColumnWidget.State.COLLAPSED:u.MailProLeftColumnWidget.State.EXPANDED},enumerable:!1,configurable:!0}),o.prototype.unobservePreviousRef=function(){this.observableRef&&(this.resizeWatcher.unwatch(this.observableRef),delete this.observableRef)},o.prototype.observeCurrentRef=function(){this.rootRef.current&&(this.resizeWatcher.watch(this.rootRef.current,this.onResize,{box:"border-box"}),this.observableRef=this.rootRef.current)},o.prototype.markWidgetShown=function(){this.widgetStateStore.markWidgetShown(this.widgetMetrikaState)},Object.defineProperty(o.prototype,"widgetMetrikaState",{get:function(){return this.widgetState===u.MailProLeftColumnWidget.State.EXPANDED?"Expanded":"Collapsed"},enumerable:!1,configurable:!0}),n([a.computed],o.prototype,"widgetState",null),o=n([l.observer],o)})(i.default.PureComponent);o.ConnectedLeftColumnWidget=p},4093:function(e,o,t){"use strict";var r=this&&this.__decorate||function(e,o,t,r){var n,s=arguments.length,i=s<3?o:null===r?r=Object.getOwnPropertyDescriptor(o,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,o,t,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(i=(s<3?n(i):s>3?n(o,t,i):n(o,t))||i);return s>3&&i&&Object.defineProperty(o,t,i),i},n=this&&this.__read||function(e,o){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var r,n,s=t.call(e),i=[];try{for(;(void 0===o||o-- >0)&&!(r=s.next()).done;)i.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(t=s.return)&&t.call(s)}finally{if(n)throw n.error}}return i},s=this&&this.__spread||function(){for(var e=[],o=0;o<arguments.length;o++)e=e.concat(n(arguments[o]));return e},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0}),o.LeftColumnProWidgetState=void 0;var a=t(324),l=t(134),d=t(4094),c=t(341),u=t(368),f=t(329),m=t(512),h=i(t(415)),p=(function(){function e(e,o,t){this.promosStore=e,this.settingsStore=o,this.settingsService=t,this.closedByUser=!1,this.stayExpanded=!1,this.wasShown=!1}return Object.defineProperty(e.prototype,"texts",{get:function(){var e;return(null===(e=this.promosStore.settings)||void 0===e?void 0:e.texts)||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"href",{get:function(){var e;return(null===(e=this.promosStore.settings)||void 0===e?void 0:e.link)||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"collapsed",{get:function(){if(this.closedByUser)return!0;if(this.strategy===d.PromoStrategy.ALWAYS_EXPANDED)return!1;var e=this.settingsStore.leftColumnProWidgetExpandAt;return!!e&&((this.strategy!==d.PromoStrategy.COLLAPSE_ON_SHOW||!this.stayExpanded)&&e>=u.promoNow())},enumerable:!1,configurable:!0}),e.prototype.closeWidget=function(){this.closedByUser=!0,this.logEvent("Collapse"),this.strategy!==d.PromoStrategy.ALWAYS_EXPANDED&&this.strategy===d.PromoStrategy.COLLAPSE_ON_CLOSE&&this.updateExpandAtSetting()},e.prototype.markWidgetShown=function(e){this.wasShown||(this.logEvent(e,"Show"),this.wasShown=!0,this.strategy===d.PromoStrategy.COLLAPSE_ON_SHOW&&(this.collapsed||(this.stayExpanded=!0,this.updateExpandAtSetting())))},e.prototype.logClick=function(e){this.logEvent(e,"Click")},Object.defineProperty(e.prototype,"strategy",{get:function(){var e=this.promosStore.settings;return e?e.strategy:d.PromoStrategy.ALWAYS_EXPANDED},enumerable:!1,configurable:!0}),e.prototype.updateExpandAtSetting=function(){if(this.promosStore.settings){var e=this.promosStore.settings.keepCollapsedDays*m.DAY,o=u.promoNow()+e;this.settingsService.setLeftColumnProWidgetExpandAt(o)}},e.prototype.logEvent=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];f.logMetric(s(["Left column","Mail pro widget"],e))},e.instance=l.memoize((function(){return new e(d.LeftColumnPromosStore.Instance(),c.getSettingsStore(),h.default.instance())})),r([a.observable],e.prototype,"closedByUser",void 0),r([a.observable],e.prototype,"stayExpanded",void 0),r([a.computed],e.prototype,"texts",null),r([a.computed],e.prototype,"href",null),r([a.computed],e.prototype,"collapsed",null),r([a.action],e.prototype,"closeWidget",null),r([a.action],e.prototype,"markWidgetShown",null),r([a.computed],e.prototype,"strategy",null),e})();o.LeftColumnProWidgetState=p},4095:function(e,o,t){"use strict";var r=this&&this.__extends||(function(){var e=function(o,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(e[t]=o[t])})(o,t)};return function(o,t){function r(){this.constructor=o}e(o,t),o.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}})(),n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0}),o.MailProLeftColumnWidget=void 0;var s=n(t(321)),i=n(t(326)),a=n(t(338)),l=n(t(325)),d=n(t(4096)),c=(function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return r(o,e),o.prototype.render=function(){var e=this.props,o=e.texts,t=e.state,r=e.onClose,n=e.onClick,c=e.href,u=e.rootRef,f=i.default(d.default.root,d.default[t]);return s.default.createElement("div",null,s.default.createElement("article",{className:f,ref:u},s.default.createElement("i",{className:d.default.icon}),s.default.createElement("button",{className:d.default.close,onClick:r},s.default.createElement(a.default,{id:"mail--CloseBold"})),s.default.createElement("a",{className:d.default.content,href:c,target:"_blank",rel:"noreferrer noopener",onClick:n},s.default.createElement("div",{className:d.default.texts},s.default.createElement("h1",{className:d.default.heading},o.title),s.default.createElement("p",{className:d.default.description},o.description)),s.default.createElement("span",{className:d.default.button},o.button))),s.default.createElement("p",{className:d.default.adLabel},s.default.createElement(l.default,{loc:"common-react/left-column-ads-title"})))},o})(s.default.PureComponent);o.MailProLeftColumnWidget=c,(function(e){!(function(e){e.EXPANDED="expanded",e.COLLAPSED="collapsed",e.HIDDEN="hidden"})(e.State||(e.State={}))})(c=o.MailProLeftColumnWidget||(o.MailProLeftColumnWidget={})),o.MailProLeftColumnWidget=c},4096:function(e,o){e.exports={root:"mail-pro-left-column-widget__root--H0Z8l",content:"mail-pro-left-column-widget__content---AD6C",close:"mail-pro-left-column-widget__close--eFtpo",texts:"mail-pro-left-column-widget__texts--s0yA9",heading:"mail-pro-left-column-widget__heading--3FiID",description:"mail-pro-left-column-widget__description--6SXOs",button:"mail-pro-left-column-widget__button--33UGM",icon:"mail-pro-left-column-widget__icon--3JP2c",collapsed:"mail-pro-left-column-widget__collapsed--1IYwd",hidden:"mail-pro-left-column-widget__hidden--3QVqV",adLabel:"mail-pro-left-column-widget__adLabel--APQOX"}},4097:function(e,o,t){"use strict";function r(e){var o=e.contentBoxSize;return Array.isArray(o)&&o.length>0?{width:o[0].inlineSize,height:o[0].blockSize}:!Array.isArray(o)&&o?{width:o.inlineSize,height:o.blockSize}:e.contentRect?{width:e.contentRect.width,height:e.contentRect.height}:null}var n=this&&this.__values||function(e){var o="function"==typeof Symbol&&Symbol.iterator,t=o&&e[o],r=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(o,"__esModule",{value:!0}),o.ResizeWatcher=o.getResizeObserverEntrySize=void 0;var s=t(134);o.getResizeObserverEntrySize=r;var i=(function(){function e(){var e=this;this.callbacks=new Map,this.onResize=function(o){var t,s;try{for(var i=n(o),a=i.next();!a.done;a=i.next()){var l=a.value;!(function(o){var t=r(o),n=e.callbacks.get(o.target);n&&requestAnimationFrame((function(){n(t,o)}))})(l)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(s=i.return)&&s.call(i)}finally{if(t)throw t.error}}},this.resizeObserver="ResizeObserver"in window?new ResizeObserver(s.throttle(this.onResize,50)):null}return e.prototype.watch=function(e,o,t){this.resizeObserver&&(this.callbacks.set(e,o),this.resizeObserver.observe(e,t))},e.prototype.unwatch=function(e){this.resizeObserver&&(this.callbacks.delete(e),this.resizeObserver.unobserve(e))},e})();o.ResizeWatcher=i}});